<!doctype html><html lang="ja"><head><meta charset="utf-8"><meta httpequiv="x-ua-compatible" content="ie=edge"><meta httpequiv="content-language" content="ja"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="p:domain_verify" content="2accdaac3153e1b438ab307ac5c4b855"><link rel="prefetch" href="/fonts/icomoon.woff2?s0mo8f"><link rel="preconnect dns-prefetch" href="//i.imgur.com"><meta name="generator" content="Gatsby 4.23.1"><meta data-react-helmet name="keyword" content="blog, tubone, IT, Developer, Python, GitHub, Nuxt.js"><meta data-react-helmet name="theme-color" content="#33b546"><meta data-react-helmet name="msapplication-navbutton-color" content="#33b546"><meta data-react-helmet name="apple-mobile-web-app-capable" content="yes"><meta data-react-helmet name="apple-mobile-web-app-status-bar-style" content="#33b546"><meta data-react-helmet name="google-site-verification" content="--LalgZ9bPi0TeRovPWh1jMxI1TuCs0dESPlyDtR_EQ"><meta data-react-helmet name="description" content="2020/05/30に発生したDatadog AgentのCERTIFICATE_VERIFY_FAILED error
について少し考察してみようかと思います。 Table of Contents CERTIFICATE_VERIFY_FAILED は突然に Datadog…"><meta data-react-helmet name="image" content="https://i.imgur.com/iIZqvaV.jpg"><meta data-react-helmet property="og:url" content="https://blog.tubone-project24.xyz/2020/06/01/ssl-cert"><meta data-react-helmet property="og:type" content="article"><meta data-react-helmet property="og:title" content="クロスルート証明書について考えてみる"><meta data-react-helmet property="og:description" content="2020/05/30に発生したDatadog AgentのCERTIFICATE_VERIFY_FAILED error
について少し考察してみようかと思います。 Table of Contents CERTIFICATE_VERIFY_FAILED は突然に Datadog…"><meta data-react-helmet property="og:image" content="https://i.imgur.com/iIZqvaV.jpg"><meta data-react-helmet property="fb:app_id" content="280941406476272"><meta data-react-helmet name="twitter:card" content="summary_large_image"><meta data-react-helmet name="twitter:creator" content="@meitante1conan"><meta data-react-helmet name="twitter:title" content="クロスルート証明書について考えてみる"><meta data-react-helmet name="twitter:description" content="2020/05/30に発生したDatadog AgentのCERTIFICATE_VERIFY_FAILED error
について少し考察してみようかと思います。 Table of Contents CERTIFICATE_VERIFY_FAILED は突然に Datadog…"><meta data-react-helmet name="twitter:image" content="https://i.imgur.com/iIZqvaV.jpg"><meta name="theme-color" content="#33b546"><style data-href="/styles.1f9f9129472fbedc3a4a.css" data-identity="gatsby-global-css">.nav-btn{position:relative}.nav-btn:after{background:#0f457f none repeat scroll 0 0;content:"";display:block;height:.1rem;transition:width .4s ease 0s;width:0}.nav-btn:hover{text-decoration:none}.nav-btn:hover:after{width:100%}.navbar-nav .nav-btn{color:#005b94}.z_7{background-color:#f3f8f4;box-shadow:0 0 20px hsla(0,0%,5%,.26);padding:.5rem 1.5rem;transition:background .5s}.z_8{border:0}.z_9{align-items:center}.z_bb img{height:45px;margin-bottom:-10px;margin-top:-15px;width:auto}.y_5{font-size:12px;padding-bottom:2rem}.y_5 a{color:#0248b1}.y_6{color:#2d4e68;margin-top:-.5rem}.fadeIn{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:fadeIn;animation-name:fadeIn}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.layout{background-color:#d5ffd7}.layout img{max-width:100%}.gatsby-code-title{background:#272822;border-top-left-radius:.3em;border-top-right-radius:.3em;display:block;position:relative;top:10px;width:100%}.gatsby-highlight-code-line{background-color:#343426;border-left:.25em solid #f99;display:block;margin-left:-1em;margin-right:-1em;padding-left:.75em;padding-right:1em}.gatsby-code-title span{background:#777;border-bottom-right-radius:.3em;border-top-left-radius:.3em;color:#eee;display:inline;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;padding:3px;position:relative;top:1px}.gatsby-highlight{overflow-x:scroll}.gatsby-highlight code[class*=language-],.gatsby-highlight pre[class*=language-]{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace!important}.gatsby-highlight pre[class*=language-].line-numbers{padding:0 0 0 2.8em}.gatsby-highlight pre[class*=language-].line-numbers .line-numbers-rows{margin-left:5px}#toc_container{background:#f9f9f9 none repeat scroll 0 0;border:1px solid #aaa;display:table;font-size:95%;margin-bottom:1em;padding:20px;width:auto}.toc_title{font-weight:700;text-align:center}#toc_container li,#toc_container ul,#toc_container ul li{list-style:none outside none!important}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:0 0;color:#f8f8f2;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;text-shadow:0 1px rgba(0,0,0,.3);white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}pre[class*=language-].line-numbers{counter-reset:linenumber;padding-left:3.8em;position:relative}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{border-right:1px solid #999;font-size:100%;left:-3.8em;letter-spacing:-1px;pointer-events:none;position:absolute;top:0;-webkit-user-select:none;user-select:none;width:3em}.line-numbers-rows>span{counter-increment:linenumber;display:block}.line-numbers-rows>span:before{color:#999;content:counter(linenumber);display:block;padding-right:.8em;text-align:right}.command-line-prompt{border-right:1px solid #999;display:block;float:left;font-size:100%;letter-spacing:-1px;margin-right:1em;pointer-events:none;text-align:right;-webkit-user-select:none;user-select:none}.command-line-prompt>span:before{content:" ";display:block;opacity:.7;padding-right:.8em}.command-line-prompt>span[data-user]:before{content:"[" attr(data-user) "@" attr(data-host) "] $"}.command-line-prompt>span[data-user=root]:before{content:"[" attr(data-user) "@" attr(data-host) "] #"}.command-line-prompt>span[data-prompt]:before{content:attr(data-prompt)}.command-line-prompt>span[data-continuation-prompt]:before{content:attr(data-continuation-prompt)}.command-line span.token.output{opacity:.7}/*!
 * Bootstrap  v5.2.2 (https://getbootstrap.com/)
 * Copyright 2011-2022 The Bootstrap Authors
 * Copyright 2011-2022 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
 */:root{--bs-blue:#0d6efd;--bs-indigo:#6610f2;--bs-purple:#6f42c1;--bs-pink:#d63384;--bs-red:#dc3545;--bs-orange:#fd7e14;--bs-yellow:#ffc107;--bs-green:#198754;--bs-teal:#20c997;--bs-cyan:#0dcaf0;--bs-black:#000;--bs-white:#fff;--bs-gray:#6c757d;--bs-gray-dark:#343a40;--bs-gray-100:#f8f9fa;--bs-gray-200:#e9ecef;--bs-gray-300:#dee2e6;--bs-gray-400:#ced4da;--bs-gray-500:#adb5bd;--bs-gray-600:#6c757d;--bs-gray-700:#495057;--bs-gray-800:#343a40;--bs-gray-900:#212529;--bs-primary:#0d6efd;--bs-secondary:#6c757d;--bs-success:#198754;--bs-info:#0dcaf0;--bs-warning:#ffc107;--bs-danger:#dc3545;--bs-light:#f8f9fa;--bs-dark:#212529;--bs-primary-rgb:13,110,253;--bs-secondary-rgb:108,117,125;--bs-success-rgb:25,135,84;--bs-info-rgb:13,202,240;--bs-warning-rgb:255,193,7;--bs-danger-rgb:220,53,69;--bs-light-rgb:248,249,250;--bs-dark-rgb:33,37,41;--bs-white-rgb:255,255,255;--bs-black-rgb:0,0,0;--bs-body-color-rgb:33,37,41;--bs-body-bg-rgb:255,255,255;--bs-font-sans-serif:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue","Noto Sans","Liberation Sans",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--bs-font-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--bs-gradient:linear-gradient(180deg,hsla(0,0%,100%,.15),hsla(0,0%,100%,0));--bs-body-font-family:var(--bs-font-sans-serif);--bs-body-font-size:1rem;--bs-body-font-weight:400;--bs-body-line-height:1.5;--bs-body-color:#212529;--bs-body-bg:#fff;--bs-border-width:1px;--bs-border-style:solid;--bs-border-color:#dee2e6;--bs-border-color-translucent:rgba(0,0,0,.175);--bs-border-radius:0.375rem;--bs-border-radius-sm:0.25rem;--bs-border-radius-lg:0.5rem;--bs-border-radius-xl:1rem;--bs-border-radius-2xl:2rem;--bs-border-radius-pill:50rem;--bs-link-color:#0d6efd;--bs-link-hover-color:#0a58ca;--bs-code-color:#d63384;--bs-highlight-bg:#fff3cd}*,:after,:before{box-sizing:border-box}@media(prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent;background-color:var(--bs-body-bg);color:var(--bs-body-color);font-family:var(--bs-body-font-family);font-size:var(--bs-body-font-size);font-weight:var(--bs-body-font-weight);line-height:var(--bs-body-line-height);margin:0;text-align:var(--bs-body-text-align)}hr{border:0;border-top:1px solid;color:inherit;margin:1rem 0;opacity:.25}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{font-weight:500;line-height:1.2;margin-bottom:.5rem;margin-top:0}.h1,h1{font-size:calc(1.375rem + 1.5vw)}@media(min-width:1200px){.h1,h1{font-size:2.5rem}}.h2,h2{font-size:calc(1.325rem + .9vw)}@media(min-width:1200px){.h2,h2{font-size:2rem}}.h3,h3{font-size:calc(1.3rem + .6vw)}@media(min-width:1200px){.h3,h3{font-size:1.75rem}}.h4,h4{font-size:calc(1.275rem + .3vw)}@media(min-width:1200px){.h4,h4{font-size:1.5rem}}.h5,h5{font-size:1.25rem}.h6,h6{font-size:1rem}p{margin-bottom:1rem;margin-top:0}ol,ul{margin-bottom:1rem;margin-top:0;padding-left:2rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}.small,small{font-size:.875em}a{color:var(--bs-link-color);text-decoration:underline}a:hover{color:var(--bs-link-hover-color)}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,pre{font-family:var(--bs-font-monospace);font-size:1em}pre{display:block;font-size:.875em;margin-bottom:1rem;margin-top:0;overflow:auto}pre code{color:inherit;font-size:inherit;word-break:normal}code{word-wrap:break-word;color:var(--bs-code-color);font-size:.875em}a>code{color:inherit}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{border-collapse:collapse;caption-side:bottom}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,th,thead,tr{border:0 solid;border-color:inherit}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input{font-family:inherit;font-size:inherit;line-height:inherit;margin:0}button{text-transform:none}[role=button]{cursor:pointer}[type=button],button{-webkit-appearance:button}[type=button]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{border-style:none;padding:0}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}::file-selector-button{-webkit-appearance:button;font:inherit}summary{cursor:pointer;display:list-item}.blockquote{font-size:1.25rem;margin-bottom:1rem}.blockquote>:last-child{margin-bottom:0}.figure{display:inline-block}.container,.container-fluid{--bs-gutter-x:1.5rem;--bs-gutter-y:0;margin-left:auto;margin-right:auto;padding-left:calc(var(--bs-gutter-x)*.5);padding-right:calc(var(--bs-gutter-x)*.5);width:100%}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container{max-width:720px}}@media(min-width:992px){.container{max-width:960px}}@media(min-width:1200px){.container{max-width:1140px}}@media(min-width:1400px){.container{max-width:1320px}}.row{--bs-gutter-x:1.5rem;--bs-gutter-y:0;display:flex;flex-wrap:wrap;margin-left:calc(var(--bs-gutter-x)*-.5);margin-right:calc(var(--bs-gutter-x)*-.5);margin-top:calc(var(--bs-gutter-y)*-1)}.row>*{flex-shrink:0;margin-top:var(--bs-gutter-y);max-width:100%;padding-left:calc(var(--bs-gutter-x)*.5);padding-right:calc(var(--bs-gutter-x)*.5);width:100%}.col{flex:1 0}.col-12{flex:0 0 auto;width:100%}@media(min-width:576px){.col-sm-12{flex:0 0 auto;width:100%}}@media(min-width:768px){.col-md-12{flex:0 0 auto;width:100%}}@media(min-width:992px){.col-lg-1{flex:0 0 auto;width:8.33333333%}.col-lg-3{flex:0 0 auto;width:25%}.col-lg-6{flex:0 0 auto;width:50%}.col-lg-7{flex:0 0 auto;width:58.33333333%}}@media(min-width:1200px){.col-xl-2{flex:0 0 auto;width:16.66666667%}.col-xl-6{flex:0 0 auto;width:50%}.col-xl-7{flex:0 0 auto;width:58.33333333%}}.table{--bs-table-color:var(--bs-body-color);--bs-table-bg:transparent;--bs-table-border-color:var(--bs-border-color);--bs-table-accent-bg:transparent;--bs-table-striped-color:var(--bs-body-color);--bs-table-striped-bg:rgba(0,0,0,.05);--bs-table-active-color:var(--bs-body-color);--bs-table-active-bg:rgba(0,0,0,.1);--bs-table-hover-color:var(--bs-body-color);--bs-table-hover-bg:rgba(0,0,0,.075);border-color:var(--bs-table-border-color);color:var(--bs-table-color);margin-bottom:1rem;vertical-align:top;width:100%}.table>:not(caption)>*>*{background-color:var(--bs-table-bg);border-bottom-width:1px;box-shadow:inset 0 0 0 9999px var(--bs-table-accent-bg);padding:.5rem}.table>tbody{vertical-align:inherit}.table>thead{vertical-align:bottom}.btn{--bs-btn-padding-x:0.75rem;--bs-btn-padding-y:0.375rem;--bs-btn-font-family: ;--bs-btn-font-size:1rem;--bs-btn-font-weight:400;--bs-btn-line-height:1.5;--bs-btn-color:#212529;--bs-btn-bg:transparent;--bs-btn-border-width:1px;--bs-btn-border-color:transparent;--bs-btn-border-radius:0.375rem;--bs-btn-hover-border-color:transparent;--bs-btn-box-shadow:inset 0 1px 0 hsla(0,0%,100%,.15),0 1px 1px rgba(0,0,0,.075);--bs-btn-disabled-opacity:0.65;--bs-btn-focus-box-shadow:0 0 0 0.25rem rgba(var(--bs-btn-focus-shadow-rgb),.5);background-color:var(--bs-btn-bg);border:var(--bs-btn-border-width) solid var(--bs-btn-border-color);border-radius:var(--bs-btn-border-radius);color:var(--bs-btn-color);cursor:pointer;display:inline-block;font-family:var(--bs-btn-font-family);font-size:var(--bs-btn-font-size);font-weight:var(--bs-btn-font-weight);line-height:var(--bs-btn-line-height);padding:var(--bs-btn-padding-y) var(--bs-btn-padding-x);text-align:center;text-decoration:none;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;-webkit-user-select:none;user-select:none;vertical-align:middle}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{background-color:var(--bs-btn-hover-bg);border-color:var(--bs-btn-hover-border-color);color:var(--bs-btn-hover-color)}.btn:focus-visible{background-color:var(--bs-btn-hover-bg);border-color:var(--bs-btn-hover-border-color);box-shadow:var(--bs-btn-focus-box-shadow);color:var(--bs-btn-hover-color);outline:0}.btn:first-child:active,:not(.btn-check)+.btn:active{background-color:var(--bs-btn-active-bg);border-color:var(--bs-btn-active-border-color);color:var(--bs-btn-active-color)}.btn:first-child:active:focus-visible,:not(.btn-check)+.btn:active:focus-visible{box-shadow:var(--bs-btn-focus-box-shadow)}.btn.disabled,.btn:disabled{background-color:var(--bs-btn-disabled-bg);border-color:var(--bs-btn-disabled-border-color);color:var(--bs-btn-disabled-color);opacity:var(--bs-btn-disabled-opacity);pointer-events:none}.btn-link{--bs-btn-font-weight:400;--bs-btn-color:var(--bs-link-color);--bs-btn-bg:transparent;--bs-btn-border-color:transparent;--bs-btn-hover-color:var(--bs-link-hover-color);--bs-btn-hover-border-color:transparent;--bs-btn-active-color:var(--bs-link-hover-color);--bs-btn-active-border-color:transparent;--bs-btn-disabled-color:#6c757d;--bs-btn-disabled-border-color:transparent;--bs-btn-box-shadow:none;--bs-btn-focus-shadow-rgb:49,132,253;text-decoration:underline}.btn-link:focus-visible{color:var(--bs-btn-color)}.btn-link:hover{color:var(--bs-btn-hover-color)}.collapse:not(.show){display:none}.nav{--bs-nav-link-padding-x:1rem;--bs-nav-link-padding-y:0.5rem;--bs-nav-link-font-weight: ;--bs-nav-link-color:var(--bs-link-color);--bs-nav-link-hover-color:var(--bs-link-hover-color);--bs-nav-link-disabled-color:#6c757d;display:flex;flex-wrap:wrap;list-style:none;margin-bottom:0;padding-left:0}.navbar{--bs-navbar-padding-x:0;--bs-navbar-padding-y:0.5rem;--bs-navbar-color:rgba(0,0,0,.55);--bs-navbar-hover-color:rgba(0,0,0,.7);--bs-navbar-disabled-color:rgba(0,0,0,.3);--bs-navbar-active-color:rgba(0,0,0,.9);--bs-navbar-brand-padding-y:0.3125rem;--bs-navbar-brand-margin-end:1rem;--bs-navbar-brand-font-size:1.25rem;--bs-navbar-brand-color:rgba(0,0,0,.9);--bs-navbar-brand-hover-color:rgba(0,0,0,.9);--bs-navbar-nav-link-padding-x:0.5rem;--bs-navbar-toggler-padding-y:0.25rem;--bs-navbar-toggler-padding-x:0.75rem;--bs-navbar-toggler-font-size:1.25rem;--bs-navbar-toggler-icon-bg:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3E%3Cpath stroke='rgba(0, 0, 0, 0.55)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3E%3C/svg%3E");--bs-navbar-toggler-border-color:rgba(0,0,0,.1);--bs-navbar-toggler-border-radius:0.375rem;--bs-navbar-toggler-focus-width:0.25rem;--bs-navbar-toggler-transition:box-shadow 0.15s ease-in-out;flex-wrap:wrap;padding:var(--bs-navbar-padding-y) var(--bs-navbar-padding-x);position:relative}.navbar,.navbar>.container,.navbar>.container-fluid{align-items:center;display:flex;justify-content:space-between}.navbar>.container,.navbar>.container-fluid{flex-wrap:inherit}.navbar-brand{color:var(--bs-navbar-brand-color);font-size:var(--bs-navbar-brand-font-size);margin-right:var(--bs-navbar-brand-margin-end);padding-bottom:var(--bs-navbar-brand-padding-y);padding-top:var(--bs-navbar-brand-padding-y);text-decoration:none;white-space:nowrap}.navbar-brand:focus,.navbar-brand:hover{color:var(--bs-navbar-brand-hover-color)}.navbar-nav{--bs-nav-link-padding-x:0;--bs-nav-link-padding-y:0.5rem;--bs-nav-link-font-weight: ;--bs-nav-link-color:var(--bs-navbar-color);--bs-nav-link-hover-color:var(--bs-navbar-hover-color);--bs-nav-link-disabled-color:var(--bs-navbar-disabled-color);display:flex;flex-direction:column;list-style:none;margin-bottom:0;padding-left:0}.navbar-collapse{align-items:center;flex-basis:100%;flex-grow:1}.navbar-toggler{background-color:transparent;border:var(--bs-border-width) solid var(--bs-navbar-toggler-border-color);border-radius:var(--bs-navbar-toggler-border-radius);color:var(--bs-navbar-color);font-size:var(--bs-navbar-toggler-font-size);line-height:1;padding:var(--bs-navbar-toggler-padding-y) var(--bs-navbar-toggler-padding-x);transition:var(--bs-navbar-toggler-transition)}@media(prefers-reduced-motion:reduce){.navbar-toggler{transition:none}}.navbar-toggler:hover{text-decoration:none}.navbar-toggler:focus{box-shadow:0 0 0 var(--bs-navbar-toggler-focus-width);outline:0;text-decoration:none}@media(min-width:768px){.navbar-expand-md{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-md .navbar-nav{flex-direction:row}.navbar-expand-md .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-md .navbar-toggler{display:none}}.card{--bs-card-spacer-y:1rem;--bs-card-spacer-x:1rem;--bs-card-title-spacer-y:0.5rem;--bs-card-border-width:1px;--bs-card-border-color:var(--bs-border-color-translucent);--bs-card-border-radius:0.375rem;--bs-card-box-shadow: ;--bs-card-inner-border-radius:calc(0.375rem - 1px);--bs-card-cap-padding-y:0.5rem;--bs-card-cap-padding-x:1rem;--bs-card-cap-bg:rgba(0,0,0,.03);--bs-card-cap-color: ;--bs-card-height: ;--bs-card-color: ;--bs-card-bg:#fff;--bs-card-img-overlay-padding:1rem;--bs-card-group-margin:0.75rem;word-wrap:break-word;background-clip:initial;background-color:var(--bs-card-bg);border:var(--bs-card-border-width) solid var(--bs-card-border-color);border-radius:var(--bs-card-border-radius);display:flex;flex-direction:column;height:var(--bs-card-height);min-width:0;position:relative}.card>hr{margin-left:0;margin-right:0}.card-header{background-color:var(--bs-card-cap-bg);border-bottom:var(--bs-card-border-width) solid var(--bs-card-border-color);color:var(--bs-card-cap-color);margin-bottom:0;padding:var(--bs-card-cap-padding-y) var(--bs-card-cap-padding-x)}.card-header:first-child{border-radius:var(--bs-card-inner-border-radius) var(--bs-card-inner-border-radius) 0 0}@-webkit-keyframes progress-bar-stripes{0%{background-position-x:1rem}}@keyframes progress-bar-stripes{0%{background-position-x:1rem}}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spinner-border{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1;-webkit-transform:none;transform:none}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1;-webkit-transform:none;transform:none}}.placeholder{background-color:currentcolor;cursor:wait;display:inline-block;min-height:1em;opacity:.5;vertical-align:middle}.placeholder.btn:before{content:"";display:inline-block}@-webkit-keyframes placeholder-glow{50%{opacity:.2}}@keyframes placeholder-glow{50%{opacity:.2}}@-webkit-keyframes placeholder-wave{to{-webkit-mask-position:-200% 0;mask-position:-200% 0}}@keyframes placeholder-wave{to{-webkit-mask-position:-200% 0;mask-position:-200% 0}}.sticky-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.visually-hidden{clip:rect(0,0,0,0)!important;border:0!important;height:1px!important;margin:-1px!important;overflow:hidden!important;padding:0!important;position:absolute!important;white-space:nowrap!important;width:1px!important}.d-none{display:none!important}.flex-row-reverse{flex-direction:row-reverse!important}.order-2{order:2!important}.order-3{order:3!important}.my-2{margin-bottom:.5rem!important;margin-top:.5rem!important}.pb-4{padding-bottom:1.5rem!important}.text-center{text-align:center!important}@media(min-width:992px){.d-lg-block{display:block!important}.order-lg-1{order:1!important}}@font-face{font-display:block;font-family:icomoon;font-style:normal;font-weight:400;src:url(/fonts/icomoon.eot?s0mo8f);src:url(/fonts/icomoon.eot?s0mo8f#iefix) format("embedded-opentype"),url(/fonts/icomoon.woff2?s0mo8f) format("woff2"),url(/fonts/icomoon.woff?s0mo8f) format("woff"),url(/fonts/icomoon.ttf?s0mo8f) format("truetype"),url(/fonts/icomoon.svg?s0mo8f#icomoon) format("svg")}[class*=" icon-"],[class^=icon-]{speak:never;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-family:icomoon!important;font-style:normal;font-variant:normal;font-weight:400;line-height:1;text-transform:none}.icon-clock:before{content:""}.icon-bars:before{content:""}.icon-500px:before{content:""}.icon-get-pocket:before{content:""}.icon-twitter:before{content:""}.icon-facebook:before{content:""}.icon-github:before{content:""}.icon-calendar:before{content:""}.icon-comment:before{content:""}.icon-chevron-up:before{content:""}.icon-rss:before{content:""}.icon-newspaper-o:before{content:""}.icon-search:before{content:""}.icon-tags:before{content:""}.icon-soundcloud:before{content:""}.icon-cloud:before{content:""}*{-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt";word-wrap:break-word;font-family:-apple-system,BlinkMacSystemFont,Verdana,Roboto,arial,HiraKakuProN-W3,Hiragino Kaku Gothic ProN,Hiragino Sans,BIZ UDGothic,Meiryo,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Sans Emoji;-webkit-font-kerning:normal;font-kerning:normal;font-size:inherit;line-height:inherit}a{text-decoration:none}:root{scroll-behavior:auto}.visually-hidden{clip:rect(1px,1px,1px,1px);-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;width:1px}.lozad{opacity:0}.lozad.loaded{opacity:1;transition:opacity 30ms}.g_q a{color:#0248b1}@font-face{font-family:octicons-link;src:url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format("woff")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;word-wrap:break-word;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:16px;line-height:1.5}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{background-color:#b31d28;color:#fafbfc}.markdown-body .pl-c2{background-color:#d73a49;color:#fafbfc}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{color:#22863a;font-weight:700}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{color:#005cc5;font-weight:700}.markdown-body .pl-mi{color:#24292e;font-style:italic}.markdown-body .pl-mb{color:#24292e;font-weight:700}.markdown-body .pl-md{background-color:#ffeef0;color:#b31d28}.markdown-body .pl-mi1{background-color:#f0fff4;color:#22863a}.markdown-body .pl-mc{background-color:#ffebda;color:#e36209}.markdown-body .pl-mi2{background-color:#005cc5;color:#f6f8fa}.markdown-body .pl-mdr{color:#6f42c1;font-weight:700}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{color:#032f62;text-decoration:underline}.markdown-body .octicon{fill:currentColor;display:inline-block;vertical-align:text-top}.markdown-body a{-webkit-text-decoration-skip:objects;background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body svg:not(:root){overflow:hidden}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{background:0 0;border-bottom:1px solid #dfe2e5;height:0;margin:15px 0;overflow:hidden}.markdown-body hr:after,.markdown-body hr:before{content:"";display:table}.markdown-body hr:after{clear:both}.markdown-body table{border-collapse:collapse;border-spacing:0}.markdown-body td,.markdown-body th{padding:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-bottom:0;margin-top:0}.markdown-body h1{font-size:32px;font-weight:600}.markdown-body h2{font-size:24px;font-weight:600}.markdown-body h3{font-size:20px;font-weight:600}.markdown-body h4{font-size:16px;font-weight:600}.markdown-body h5{font-size:14px;font-weight:600}.markdown-body h6{font-size:12px;font-weight:600}.markdown-body p{margin-bottom:10px;margin-top:0}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{margin-bottom:0;margin-top:0;padding-left:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px}.markdown-body pre{font:12px SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;margin-bottom:0;margin-top:0}.markdown-body .octicon{vertical-align:text-bottom}.markdown-body .pl-0{padding-left:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body:after,.markdown-body:before{content:"";display:table}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:0}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-bottom:16px;margin-top:0}.markdown-body hr{background-color:#e1e4e8;border:0;height:.25em;margin:24px 0;padding:0}.markdown-body blockquote{border-left:.25em solid #dfe2e5;color:#6a737d;padding:0 1em}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd{border:1px solid #c6cbd1;border-bottom-color:#959da5;box-shadow:inset 0 -1px 0 #959da5;font-size:11px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{border-bottom:1px solid #eaecef;padding-bottom:.3em}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{color:#6a737d;font-size:.85em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-bottom:0;margin-top:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{font-size:1em;font-style:italic;font-weight:600;margin-top:16px;padding:0}.markdown-body dl dd{margin-bottom:16px;padding:0 16px}.markdown-body table{display:block;overflow:auto;width:100%}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:6px 13px}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{background-color:#fff;box-sizing:initial;max-width:100%}.markdown-body code{background-color:rgba(27,31,35,.05);border-radius:3px;font-size:85%;margin:0;padding:.2em 0}.markdown-body code:after,.markdown-body code:before{content:"\A0";letter-spacing:-.2em}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{background:0 0;border:0;font-size:100%;margin:0;padding:0;white-space:pre;word-break:normal}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{background-color:#f6f8fa;border-radius:3px;font-size:85%;line-height:1.45;overflow:auto;padding:16px}.markdown-body pre code{word-wrap:normal;background-color:initial;border:0;display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0}.markdown-body pre code:after,.markdown-body pre code:before{content:normal}.markdown-body .full-commit .btn-outline:not(:disabled):hover{border-color:#005cc5;color:#005cc5}.markdown-body kbd{background-color:#fafbfc;border:1px solid #d1d5da;border-bottom-color:#c6cbd1;border-radius:3px;box-shadow:inset 0 -1px 0 #c6cbd1;color:#444d56;display:inline-block;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;line-height:10px;padding:3px 5px;vertical-align:middle}.markdown-body :checked+.radio-label{border-color:#0366d6;position:relative;z-index:1}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}.markdown-body hr{border-bottom-color:#eee}.gt-container{font-size:16px}.gt-container,.gt-container *{box-sizing:border-box}.gt-container a{color:#6190e8}.gt-container a:hover{border-color:#81a6ed;color:#81a6ed}.gt-container a.is--active{color:#333;cursor:default!important}.gt-container a.is--active:hover{color:#333}.gt-container .hide{display:none!important}.gt-container .gt-svg{display:inline-block;height:1em;vertical-align:sub;width:1em}.gt-container .gt-svg svg{fill:#6190e8;height:100%;width:100%}.gt-container .gt-ico{display:inline-block}.gt-container .gt-ico-text{margin-left:.3125em}.gt-container .gt-ico-github,.gt-container .gt-ico-github .gt-svg{height:100%;width:100%}.gt-container .gt-ico-github svg{fill:inherit}.gt-container .gt-spinner{position:relative}.gt-container .gt-spinner:before{-webkit-animation:gt-kf-rotate .6s linear infinite;animation:gt-kf-rotate .6s linear infinite;border:1px solid #fff;border-radius:50%;border-top-color:#6190e8;box-sizing:border-box;content:"";height:.75em;margin-left:-.375em;margin-top:-.1875em;position:absolute;top:3px;width:.75em}.gt-container .gt-loader{-webkit-animation:gt-kf-rotate 1.5s ease infinite;animation:gt-kf-rotate 1.5s ease infinite;border:1px solid #999;border-radius:50%;display:inline-block;font-style:normal;height:1.75em;line-height:1.75em;position:relative;width:1.75em}.gt-container .gt-loader:before{background-color:#999;border-radius:50%;content:"";display:block;height:.375em;left:50%;margin-left:-.1875em;margin-top:-.1875em;position:absolute;top:0;width:.375em}.gt-container .gt-avatar{display:inline-block;height:3.125em;width:3.125em}@media (max-width:479px){.gt-container .gt-avatar{height:2em;width:2em}}.gt-container .gt-avatar img{border-radius:3px;height:auto;width:100%}.gt-container .gt-avatar-github{cursor:pointer;height:3em;width:3em}@media (max-width:479px){.gt-container .gt-avatar-github{height:1.875em;width:1.875em}}.gt-container .gt-btn{background-color:#6190e8;border:1px solid #6190e8;border-radius:5px;color:#fff;cursor:pointer;display:inline-block;font-size:.75em;line-height:1;outline:0;padding:.75em 1.25em;text-decoration:none;white-space:nowrap}.gt-container .gt-btn-text{font-weight:400}.gt-container .gt-btn-loading{display:inline-block;height:1em;margin-left:.5em;position:relative;vertical-align:top;width:.75em}.gt-container .gt-btn.is--disable{cursor:not-allowed;opacity:.5}.gt-container .gt-btn-login{margin-right:0}.gt-container .gt-btn-preview{background-color:#fff;color:#6190e8}.gt-container .gt-btn-preview:hover{background-color:#f2f2f2;border-color:#81a6ed}.gt-container .gt-btn-public:hover{background-color:#81a6ed;border-color:#81a6ed}.gt-container .gt-error{color:#ff3860;margin:.625em;text-align:center}.gt-container .gt-initing{padding:1.25em 0;text-align:center}.gt-container .gt-initing-text{font-size:92%;margin:.625em auto}.gt-container .gt-no-init{padding:1.25em 0;text-align:center}.gt-container .gt-link{border-bottom:1px dotted #6190e8}.gt-container .gt-link-counts,.gt-container .gt-link-project{text-decoration:none}.gt-container .gt-meta{border-bottom:1px solid #e9e9e9;font-size:1em;margin:1.25em 0;padding:1em 0;position:relative;z-index:10}.gt-container .gt-meta:after,.gt-container .gt-meta:before{content:" ";display:table}.gt-container .gt-meta:after{clear:both}.gt-container .gt-counts{margin:0 .625em 0 0}.gt-container .gt-user{float:right;font-size:92%;margin:0}.gt-container .gt-user-pic{height:16px;margin-right:.5em;vertical-align:top;width:16px}.gt-container .gt-user-inner{cursor:pointer;display:inline-block}.gt-container .gt-user .gt-ico{margin:0 0 0 .3125em}.gt-container .gt-user .gt-ico svg{fill:inherit}.gt-container .gt-user .is--poping .gt-ico svg{fill:#6190e8}.gt-container .gt-version{color:#a1a1a1;margin-left:.375em}.gt-container .gt-copyright{border-top:1px solid #e9e9e9;margin:0 .9375em .5em;padding-top:.5em}.gt-container .gt-popup{background:#fff;border:1px solid #e9e9e9;display:inline-block;font-size:.875em;letter-spacing:.5px;padding:.625em 0;position:absolute;right:0;top:2.375em}.gt-container .gt-popup .gt-action{cursor:pointer;display:block;margin:.5em 0;padding:0 1.125em;position:relative;text-decoration:none}.gt-container .gt-popup .gt-action.is--active:before{background:#6190e8;content:"";height:.25em;left:.5em;position:absolute;top:.4375em;width:.25em}.gt-container .gt-header{display:flex;position:relative}.gt-container .gt-header-comment{flex:1 1;margin-left:1.25em}@media (max-width:479px){.gt-container .gt-header-comment{margin-left:.875em}}.gt-container .gt-header-textarea{word-wrap:break-word;background-color:#f6f6f6;border:1px solid rgba(0,0,0,.1);border-radius:5px;box-sizing:border-box;display:block;font-size:.875em;max-height:15em;min-height:5.125em;outline:0;padding:.75em;resize:vertical;transition:all .25s ease;width:100%}.gt-container .gt-header-textarea:hover{background-color:#fbfbfb}.gt-container .gt-header-preview{background-color:#f6f6f6;border:1px solid rgba(0,0,0,.1);border-radius:5px;padding:.75em}.gt-container .gt-header-controls{margin:.75em 0 0;position:relative}.gt-container .gt-header-controls:after,.gt-container .gt-header-controls:before{content:" ";display:table}.gt-container .gt-header-controls:after{clear:both}@media (max-width:479px){.gt-container .gt-header-controls{margin:0}}.gt-container .gt-header-controls-tip{color:#6190e8;font-size:.875em;text-decoration:none;vertical-align:sub}@media (max-width:479px){.gt-container .gt-header-controls-tip{display:none}}.gt-container .gt-header-controls .gt-btn{float:right;margin-left:1.25em}@media (max-width:479px){.gt-container .gt-header-controls .gt-btn{float:none;margin:.75em 0 0;width:100%}}.gt-container:after{bottom:100%;content:"";left:0;opacity:0;position:fixed;right:0;top:0}.gt-container.gt-input-focused{position:relative}.gt-container.gt-input-focused:after{background:#000;bottom:0;content:"";left:0;opacity:.6;position:fixed;right:0;top:0;transition:opacity .3s,bottom 0s;z-index:9999}.gt-container.gt-input-focused .gt-header-comment{z-index:10000}.gt-container .gt-comments{padding-top:1.25em}.gt-container .gt-comments-null{text-align:center}.gt-container .gt-comments-controls{margin:1.25em 0;text-align:center}.gt-container .gt-comment{display:flex;padding:.625em 0;position:relative}.gt-container .gt-comment-content{background-color:#f9f9f9;flex:1 1;margin-left:1.25em;overflow:auto;padding:.75em 1em;transition:all .25s ease}.gt-container .gt-comment-content:hover{box-shadow:0 .625em 3.75em 0 #f4f4f4}@media (max-width:479px){.gt-container .gt-comment-content{margin-left:.875em;padding:.625em .75em}}.gt-container .gt-comment-header{font-size:.875em;margin-bottom:.5em;position:relative}.gt-container .gt-comment-block-1{float:right;height:1.375em;width:2em}.gt-container .gt-comment-block-2{float:right;height:1.375em;width:4em}.gt-container .gt-comment-username{color:#6190e8;font-weight:500;text-decoration:none}.gt-container .gt-comment-username:hover{text-decoration:underline}.gt-container .gt-comment-date,.gt-container .gt-comment-text{color:#a1a1a1;margin-left:.5em}.gt-container .gt-comment-edit,.gt-container .gt-comment-like,.gt-container .gt-comment-reply{height:1.375em;position:absolute}.gt-container .gt-comment-edit:hover,.gt-container .gt-comment-like:hover,.gt-container .gt-comment-reply:hover{cursor:pointer}.gt-container .gt-comment-like{right:2em;top:0}.gt-container .gt-comment-edit,.gt-container .gt-comment-reply{right:0;top:0}.gt-container .gt-comment-body{color:#333!important}.gt-container .gt-comment-body .email-hidden-toggle a{background:#dfe2e5;border-radius:1px;color:#444d56;display:inline-block;font-size:12px;font-weight:600;height:12px;line-height:6px;padding:0 9px;text-decoration:none;vertical-align:middle}.gt-container .gt-comment-body .email-hidden-toggle a:hover{background-color:#c6cbd1}.gt-container .gt-comment-body .email-hidden-reply{display:none;white-space:pre-wrap}.gt-container .gt-comment-body .email-hidden-reply .email-signature-reply{border-left:4px solid #dfe2e5;color:#586069;margin:15px 0;padding:0 15px}.gt-container .gt-comment-body .email-hidden-reply.expanded{display:block}.gt-container .gt-comment-admin .gt-comment-content{background-color:#f6f9fe}@-webkit-keyframes gt-kf-rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes gt-kf-rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.v_3{margin:0 auto}.B_bc a{display:block;font-weight:700}.C_bd,.C_bd img,.C_bd source{width:100%}.D_bf a{color:#337ab7;display:block;margin:5px 0;text-align:left}.D_bf a:hover{text-decoration:none}.algolia-autocomplete,.algolia-autocomplete .aa-hint,.algolia-autocomplete .aa-input{width:100%}.algolia-autocomplete .aa-hint{color:#999}.algolia-autocomplete .aa-dropdown-menu{background-color:#fff;border:1px solid #999;border-top:none;width:100%}.algolia-autocomplete .aa-dropdown-menu .aa-suggestion{cursor:pointer;padding:5px 4px}.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor{background-color:#b2d7ff}.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em{font-style:normal;font-weight:700}#algolia-search-input{border:none;padding-left:10px;width:100%}.m_B{background:#005b94;border-radius:0 4px 4px 0;color:#fff;float:left;font-size:14px;height:26px;line-height:24px;margin:5px 20px;padding:0 10px 0 12px;position:relative;text-decoration:none}.m_B:before{border-color:transparent #005b94 transparent transparent;border-style:solid;border-width:12px 12px 14px 0;height:0;left:-12px;top:0;width:0}.m_B:after,.m_B:before{content:"";position:absolute}.m_B:after{background:#fff;border-radius:2px;box-shadow:-1px -1px 2px #004977;height:4px;left:0;top:10px;width:4px}.m_B:hover{background:#e4e4e4}.m_B:hover:before{border-color:transparent #e4e4e4 transparent transparent}.n_C{-webkit-transform:translateY(0);transform:translateY(0);transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s}.n_D{background-color:#fff;padding:1em;position:relative;z-index:1}.n_F{align-items:center;display:flex;flex-wrap:wrap}.n_G{transition:box-shadow .5s cubic-bezier(.22,.61,.36,1)}.n_G:hover{box-shadow:0 0 30px 0 rgba(0,0,0,.3)}.n_G p{color:#212529}.n_H{background-color:#288378;color:#fff;padding:.8em}.n_H span{display:block;text-align:center}.n_J{color:#337ab7;margin-top:20px}.n_K{background-position:50%;background-repeat:no-repeat;background-size:cover;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);min-height:5.7rem;overflow:hidden;position:relative;transition:all .5s ease 0s}@media(min-width:576px){.n_K{min-height:15rem}}.n_K:hover{opacity:.9}.x_4{background-color:#288378;color:#fff}.l_t{background:#fff;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);height:100%;margin-left:auto;margin-right:15px;padding-bottom:10px}@media(max-width:992px){.l_t{margin-bottom:15px}}.l_v h2{font-size:1.5rem}.l_w{border-radius:50%;height:120px;margin-bottom:1rem;margin-top:1rem;transition:-webkit-transform .5s;transition:transform .5s;transition:transform .5s,-webkit-transform .5s;width:120px}.l_w:hover{-webkit-transform:scale(1.2);transform:scale(1.2)}.l_x{text-align:center}.l_y i{background:#034378;border-radius:50%;transition:background 1s cubic-bezier(.22,.61,.36,1)}.l_y .l_z span{font-size:200%}.l_y:hover{border-radius:50%}.l_y:hover i{background:#337ab7}.h_r{margin:15px}.c_d,.h_s{background-color:#d5ffd7;background-image:url(/assets/bg.svg);background-size:contain;padding:10px}.b_b,.b_c,.c_f{margin:15px}.b_c{font-size:20px}.q_M{align-items:center;background-color:#000;background-position-x:center;background-position-y:center;background-repeat:no-repeat;background-size:cover;display:flex;flex-direction:column;margin-bottom:10px;margin-top:-58px;padding:58px .8125rem .8125rem}@media(min-width:768px){.q_M{min-height:500px}}@media(max-width:767.98px){.q_M{background-size:cover}}@media(min-width:768px){.q_M{justify-content:center}}.q_N{color:#fff;font-size:1.7rem;line-height:1.875rem;margin:0 0 .75rem;text-shadow:1px 1.5px 0 #19a200,-1px -.5px 0 #19a200,-1px .5px 0 #19a200,1px -.5px 0 #19a200,0 .5px 0 #19a200,-1px 0 #19a200,-1px 0 0 #19a200,1px 0 0 #19a200}@media(max-width:991.98px){.q_N{padding-top:1.5rem}}.q_P{color:#fff;text-shadow:.5px .5px 0 #19a200,-.5px -.5px 0 #19a200,-.5px .5px 0 #19a200,.5px -.5px 0 #19a200,0 .5px 0 #19a200,-1px 0 #19a200,-1px 0 0 #19a200,1px 0 0 #19a200}@media(max-width:991.98px){.q_P{align-self:flex-end;display:flex;font-size:.75rem;height:1.2rem;justify-content:center;line-height:1.2rem;width:100%}.q_Q{margin-right:auto}.q_R{margin-right:.5rem}}.q_S{border-radius:50%;height:1.25rem;width:1.25rem}.q_S,.q_T{margin-right:.5rem}@media(min-width:992px){.q_P{font-size:1rem}}@media(min-width:768px)and (max-width:991.98px){.q_P{align-self:center;width:auto}}.s_0{background:#fff;padding:30px}.s_0 a{color:#005b94}.s_0 a:hover{color:#0085a1;text-decoration:none}.s_0 h3{font-size:23px}.s_0 h3,.s_0 h4{font-weight:400;margin-bottom:30px;margin-top:60px}.s_0 h4{font-size:20px}.s_0 h5{font-size:17px}.s_0 h5,.s_0 h6{font-weight:400;margin-bottom:30px;margin-top:60px}.s_0 h6{font-size:14px}.s_0 h1{font-size:48px;font-weight:600;margin-bottom:50px;margin-top:70px}.s_0 h2{border-bottom:3px solid;font-weight:600;margin-bottom:15px;margin-top:60px;padding-bottom:5px;position:relative}.s_0 h2:before{background-color:#1bd77f;bottom:-3px;content:"";display:block;height:3px;left:0;position:absolute;width:60px}.s_0 h3{border-left:5px solid #1bd77f;padding-left:15px}.s_0 ol,.s_0 ul{background:#f1f8ff;border-radius:9px;box-shadow:0 0 0 10px #f1f8ff;margin-bottom:0;margin-left:10px;margin-right:10px;padding:.5em .5em .5em 2em}.s_0 ol li,.s_0 ul li{line-height:1.5}.s_0 blockquote{border:3px solid #3ca5d4;border-left-width:50px;box-sizing:border-box;color:#464646;font-style:italic;margin-bottom:40px;margin-left:-5px;margin-top:40px;padding:10px 12px;position:relative}.s_0 blockquote:before{color:#fff;content:">";display:inline-block;font-size:32px;left:-40px;line-height:1;position:absolute;top:50%}.s_0 blockquote p{line-height:1.7;margin:10px 0;padding:0;position:relative;z-index:3}.s_0 blockquote cite{color:#545454;display:block;font-size:.9em;text-align:right}.s_0 table{margin-bottom:50px;margin-top:40px;width:100%}.s_0 table td,.s_0 table th{padding:10px;text-align:center}.s_0 table th td{border:1px solid #ccc;border-collapse:collapse;line-height:1.5}.s_0 table.s_1 th{background:#3f3f3f;color:#fff;font-weight:700;padding:10px;vertical-align:top;width:150px}.s_0 table.s_1 td{padding:10px;vertical-align:top;width:350px}.s_0 tr:nth-child(2n){background:#f1f8ff}.s_0 code,.s_0 pre{font-family:SFMono-Regular,Consolas,Roboto Mono,Courier New,BIZ UDGothic,Meiryo,monospace}.r_V{background:hsla(0,0%,100%,.9);bottom:0;display:flex;justify-content:space-around;left:0;position:fixed;right:0;top:auto;width:100%;z-index:10}.r_W{border:1px solid #337ab7;border-radius:50%}.r_W,.r_X{font-size:1rem;height:2rem;line-height:2rem;margin:.4rem;text-align:center;width:2rem}.r_Y{color:#337ab7;padding-left:.15rem}.r_Y,.r_Z{line-height:1.7rem}.r_Z{padding-left:.1rem}.j_g{border-radius:2px}@media screen and (max-width:990px){.j_g{padding:5px 25px}}.j_h{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);color:#333;margin-right:auto;padding:0}@media screen and (min-width:990px){.j_h{margin-left:1.5rem}}.k_g{border-radius:2px}@media screen and (max-width:990px){.k_g{padding:5px 25px}}.k_h{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);color:#333;margin-right:auto;padding:0}@media screen and (min-width:990px){.k_h{margin-left:1.5rem}}.p_L{background:#1bd77f;padding:5px}.p_L b{font-size:16pt}.d_g{border-radius:2px}@media screen and (max-width:990px){.d_g{padding:5px 25px}}.d_h{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);color:#333;margin-right:auto;padding:0}@media screen and (min-width:990px){.d_h{margin-left:1.5rem}}.w_G{transition:box-shadow .5s cubic-bezier(.22,.61,.36,1)}.w_G:hover{box-shadow:0 0 30px 0 rgba(0,0,0,.3)}.w_C{-webkit-transform:translateY(0);transform:translateY(0);transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s}.w_h{background-color:#fff;background-image:url(/assets/bg.svg);padding:.01em;position:relative;z-index:1}.w_h h4{margin:10px!important}.w_h p{color:#212529}.w_h a{color:#fff}.w_F{align-items:center;display:flex;flex-wrap:wrap}.w_J{color:#337ab7;margin-top:10px}.w_H{background-color:#288378;color:#fff;padding:.5em}.w_H span{display:block;text-align:center}.w_K{background-position:0;background-repeat:no-repeat;background-size:cover;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);min-height:5rem;overflow:hidden;position:relative;transition:all .5s ease 0s}@media(min-width:576px){.w_K{min-height:5rem}}.w_K:hover{opacity:.9}.t_2{background-color:#d5ffd7;background-image:url(/assets/bg.svg);background-size:contain;padding:10px}.f_j{margin-top:20px}.f_k{display:grid;grid-auto-flow:column;justify-content:space-around;margin-bottom:20px;max-width:100%}.f_l{background:#fff;border:1px solid #d7d7d7;border-radius:.2rem;color:#7d7d7d;display:inline-block;padding:.5rem .9rem;text-align:center;text-decoration:none}.f_m{color:#5252ff}.f_n{color:#737373}.f_p{background:#005b94;border:1px solid #d7d7d7;border-radius:.2rem;color:#f6fcff;display:inline-block;font-weight:700;padding:.5rem .9rem;text-align:center;text-decoration:none}</style><title data-react-helmet>クロスルート証明書について考えてみる | tubone BOYAKI</title><link data-react-helmet rel="shortcut icon" href="/assets/usericon.jpeg"><link data-react-helmet rel="canonical" href="https://blog.tubone-project24.xyz/2020/06/01/ssl-cert"><script data-react-helmet type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","url":"https://blog.tubone-project24.xyz/2020/06/01/ssl-cert","name":"クロスルート証明書について考えてみる","alternateName":"tubone BOYAKI"},{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://blog.tubone-project24.xyz","name":"tubone BOYAKI"}},{"@type":"ListItem","position":2,"item":{"@id":"https://blog.tubone-project24.xyz/tag/Datadog","name":"tubone BOYAKI"}},{"@type":"ListItem","position":3,"item":{"@id":"https://blog.tubone-project24.xyz/2020/06/01/ssl-cert","name":"クロスルート証明書について考えてみる","image":"https://i.imgur.com/iIZqvaV.jpg"}}]},{"@context":"http://schema.org","@type":"BlogPosting","url":"https://blog.tubone-project24.xyz/2020/06/01/ssl-cert","name":"クロスルート証明書について考えてみる","alternateName":"tubone BOYAKI","headline":"クロスルート証明書について考えてみる","image":{"@type":"ImageObject","url":"https://i.imgur.com/iIZqvaV.jpg"},"description":"2020/05/30に発生したDatadog AgentのCERTIFICATE_VERIFY_FAILED error\nについて少し考察してみようかと思います。 Table of Contents CERTIFICATE_VERIFY_FAILED は突然に Datadog…"}]</script><link rel="alternate" type="application/rss+xml" title="tubone BOYAKI" href="/rss.xml"><style>.anchor.before{position:absolute;top:0;left:0;transform:translateX(-100%);padding-right:4px}.anchor.after{display:inline-block;padding-left:4px}h1 .anchor svg,h2 .anchor svg,h3 .anchor svg,h4 .anchor svg,h5 .anchor svg,h6 .anchor svg{visibility:hidden}h1 .anchor:focus svg,h1:hover .anchor svg,h2 .anchor:focus svg,h2:hover .anchor svg,h3 .anchor:focus svg,h3:hover .anchor svg,h4 .anchor:focus svg,h4:hover .anchor svg,h5 .anchor:focus svg,h5:hover .anchor svg,h6 .anchor:focus svg,h6:hover .anchor svg{visibility:visible}</style><script>document.addEventListener("DOMContentLoaded",(function(e){var o=window.decodeURI(location.hash.replace("#",""));if(""!==o){var n=document.getElementById(o);if(n){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,d=document.documentElement.clientTop||document.body.clientTop||0,c=n.getBoundingClientRect().top+t-d;setTimeout((function(){window.scrollTo(0,c-0)}),0)}}}))</script><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"><link rel="apple-touch-icon" sizes="192x192" href="/favicons/android-chrome-192x192.png"><link rel="apple-touch-icon" sizes="512x512" href="/favicons/android-chrome-512x512.png"></head><body><script src="/adstir.js"></script><script src="https://js.ad-stir.com/js/adstir.js" nonce="ZsQmvvc24RF0Q3OGhq"></script><div id="___gatsby"><div style="outline:0" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout"><nav id="m-navbar" title="navbar" class="navbar navbar-expand-md sticky-top z_7 navbar-night"><div class="container"><button type="button" data-testid="logo" class="z_bb navbar-brand btn btn-default"><img src="/assets/logo3.svg" alt width="135" height="45" data-testid="logo-img"><h1 class="visually-hidden">Japanese IT Developer's Blog tubone BOYAKI</h1></button><button type="button" data-bs-toggle="collapse" aria-label="navbar-toggler" data-bs-target="#navbarSupportedContent" class="z_8 navbar-toggler"><span class="icon-bars"></span></button><div id="navbarSupportedContent" role="navigation" class="collapse navbar-collapse flex-row-reverse"><ul class="z_9 navbar-nav mr-2"><li><a href="/tags/" class="nav-btn btn btn-link">Tags</a></li><li><a href="/about/" class="nav-btn btn btn-link">About</a></li><li><a href="https://portfolio.tubone-project24.xyz/#contact" rel="external nofollow noopener" target="_blank" class="nav-btn btn btn-link">Contact</a></li><li><a href="https://portfolio.tubone-project24.xyz" rel="external nofollow noopener" target="_blank" class="nav-btn btn btn-link">Portfolio</a></li><li><a href="https://note.tubone-project24.xyz" rel="external nofollow noopener" target="_blank" class="nav-btn btn btn-link">Note</a></li><li><a href="https://tubone24.github.io/boyakifm/" rel="external nofollow noopener" target="_blank" class="nav-btn btn btn-link">FM</a></li></ul></div></div></nav><div><div style="transition:opacity .1s ease-in-out;opacity:1"><div class="container-fluid"><div class="d_g row order-2"><div style="padding:0" id="header" data-testid="header" class="col-12 header"><div style="background-image:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2)),url(https://i.imgur.com/iIZqvaV.jpg)" class="q_M"><h1 class="q_N">クロスルート証明書について考えてみる</h1><div class="q_P"><div class="q_Q"><picture><source srcset="/assets/avater.webp" type="image/webp" class="q_S"><img src="/assets/avater.png" alt="tubone" class="q_S"></picture><span class="q_T">tubone</span></div><span class="q_R">2020/06/01</span></div></div></div><header class="l_t site-heading text-center col-xl-2 col-lg-3 col-xs-12 order-lg-1"><div class="l_v"><a href="https://portfolio.tubone-project24.xyz/"><picture><source srcset="/assets/avater.webp" type="image/webp" class="l_w"><img src="/assets/avater.png" alt="tubone" decoding="async" class="l_w"></picture></a><a href="https://portfolio.tubone-project24.xyz/"><h2>tubone</h2></a><p class="l_x">It's my life</p><a target="_blank" href="https://github.com/tubone24" title="tubone24 github" rel="external nofollow noopener noreferrer" class="l_y"><span class="l_z fa-fw fa-2x"><span class="icon-github"></span> </span></a><a target="_blank" href="https://soundcloud.com/user-453736300" title="tubone24 SoundCloud" rel="external nofollow noopener noreferrer" class="l_y"><span class="l_z fa-fw fa-2x"><span class="icon-soundcloud"></span> </span></a><a target="_blank" href="https://twitter.com/meitante1conan" title="tubone24 twitter" rel="external nofollow noopener noreferrer" class="l_y"><span class="l_z fa-fw fa-2x"><span class="icon-twitter"></span> </span></a><a target="_blank" href="https://500px.com/tubone24" title="tubone24 500px" rel="external nofollow noopener noreferrer" class="l_y"><span class="l_z fa-fw fa-2x"><span class="icon-500px"></span> </span></a><div class="d-none d-lg-block my-2"><hr><div class="D_bf"><p><span class="icon-newspaper-o"></span> Recent posts  6 / 110</p><a href="/2022/08/29/wezterm">8年くらい使ってきたiTerm2 + tmuxの構成からWez's Terminalに移行してみる</a><a href="/2022/04/25/renovate-error">Renovateの作るPRでArtifact update problemが出た時の対処法</a><a href="/2022/4/22/textlint">ブログのプレビューデプロイ時にtextlintを導入してみた</a><a href="/2022/04/11/echo-show-15">Echo Show 15を買ってみての感想</a><a href="/2022/04/09/lambda-urls">AWS Lambda Function URLsがリリースされたのでタイムアウトの挙動を確かめてみる</a><a href="/2022/03/20/k6-with-typescript">負荷テストツールK6をTypeScript+Dockerで動かすためのテンプレートを作る</a></div><hr><div class="B_bc"><p><span class="icon-calendar"></span> Archives</p><a title="Articles written in 2022" href="/2022/">2022</a><a title="Articles written in 2021" href="/2021/">2021</a><a title="Articles written in 2020" href="/2020/">2020</a><a title="Articles written in 2019" href="/2019/">2019</a><a title="Articles written in 2018" href="/2018/">2018</a><a title="Articles written in 2017" href="/2017/">2017</a><a title="Articles written in 2011" href="/2011/">2011</a></div><hr><div class="C_bd"><p><span class="icon-cloud"></span> WordCloud</p><a href="/about#wordcloud"><picture><source media="(min-width: 992px)" srcset="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-srcset="https://raw.githubusercontent.com/tubone24/auto_tweet_wordcloud/master/word_cloud_blog.webp" type="image/webp" class="lozad"><source media="(max-width: 991px)" srcset="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" type="image/gif" class="lozad"><img src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://raw.githubusercontent.com/tubone24/auto_tweet_wordcloud/master/word_cloud_blog.png" alt="wordCloud" title="wordCloud" class="lozad"></picture></a></div><hr></div><div><p><label for="algolia-search-input"><span class="icon-search"></span> SearchBox</label></p><input type="search" id="algolia-search-input" placeholder="Enter the keyword..." data-testid="algolia-search-input"></div><hr><div class="subscription"><a href="/rss.xml" role="button" class="x_4 btn">SUBSCRIBE RSS <span class="fa-layers fa-fw fa-1x"><span class="icon-rss"></span></span></a></div><hr><div class="d-none d-lg-block information my-2"><a title="Tags" href="/tags"><p><span class="icon-tags"></span> 20 / 230 Tags</p></a><a title="ぼやき" href="/tag/ぼやき" class="m_B">ぼやき 24</a><a title="JavaScript" href="/tag/JavaScript" class="m_B">JavaScript 19</a><a title="GitHub" href="/tag/GitHub" class="m_B">GitHub 12</a><a title="TypeScript" href="/tag/TypeScript" class="m_B">TypeScript 7</a><a title="Vue.js" href="/tag/Vue.js" class="m_B">Vue.js 6</a><a title="ラーメン" href="/tag/ラーメン" class="m_B">ラーメン 6</a><a title="AWS" href="/tag/AWS" class="m_B">AWS 6</a><a title="機械学習" href="/tag/機械学習" class="m_B">機械学習 6</a><a title="React" href="/tag/React" class="m_B">React 5</a><a title="Python" href="/tag/Python" class="m_B">Python 5</a><a title="Gatsby.js" href="/tag/Gatsby.js" class="m_B">Gatsby.js 4</a><a title="デブ活" href="/tag/デブ活" class="m_B">デブ活 4</a><a title="Lambda" href="/tag/Lambda" class="m_B">Lambda 4</a><a title="GraphQL" href="/tag/GraphQL" class="m_B">GraphQL 4</a><a title="資格" href="/tag/資格" class="m_B">資格 4</a><a title="Nuxt.js" href="/tag/Nuxt.js" class="m_B">Nuxt.js 4</a><a title="自動テスト" href="/tag/自動テスト" class="m_B">自動テスト 3</a><a title="仮想化" href="/tag/仮想化" class="m_B">仮想化 3</a><a title="Auto Provisioning" href="/tag/Auto Provisioning" class="m_B">Auto Provisioning 3</a><a title="Ansible" href="/tag/Ansible" class="m_B">Ansible 3</a></div></div></header><main class="d_h col-xl-7 col-lg-6 col-md-12 col-sm-12 order-2"><div data-testid="countdown" class="p_L"><span class="fa-layers fa-fw fa-1x"><span class="icon-clock"></span></span>この記事は<b>8811文字</b>で<b>約23分</b>で読めます</div><div data-testid="innerHTML" class="s_0"><p>2020/05/30に発生したDatadog Agentの<a href="https://docs.datadoghq.com/agent/faq/certificate_verify_failed-error/" target="_blank" rel="noopener noreferrer"><strong>CERTIFICATE_VERIFY_FAILED error</strong> </a>について少し考察してみようかと思います。</p><h2 id="table-of-contents" style="position:relative"><a href="#table-of-contents" aria-label="table of contents permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Table of Contents</h2><div class="toc"><ul><li><p><a href="#certificate_verify_failed-%E3%81%AF%E7%AA%81%E7%84%B6%E3%81%AB">CERTIFICATE_VERIFY_FAILED は突然に</a></p></li><li><p><a href="#datadog%E3%81%8B%E3%82%89%E3%81%AE%E3%82%A2%E3%83%8A%E3%82%A6%E3%83%B3%E3%82%B9">Datadogからのアナウンス</a></p></li><li><p><a href="#%E3%81%9D%E3%82%82%E3%81%9D%E3%82%82ssl%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF%E3%82%92%E3%81%8A%E3%81%95%E3%82%89%E3%81%84">そもそもSSLの仕組みをおさらい</a></p></li><li><p><a href="#ssl%E9%80%9A%E4%BF%A1%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E8%AA%8D%E8%A8%BC%E3%81%A8%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E8%A8%BC%E6%98%8E%E6%9B%B8">SSL通信におけるサーバー認証とサーバー証明書</a></p><ul><li><a href="#%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E4%B8%AD%E8%BA%AB">サーバー証明書の中身</a></li></ul></li><li><p><a href="#%E8%AA%8D%E8%A8%BC%E5%B1%80">認証局</a></p><ul><li><a href="#%E6%89%8B%E9%A0%86%E3%81%AE%E3%81%8A%E3%81%95%E3%82%89%E3%81%84">手順のおさらい</a></li><li><a href="#%E3%83%91%E3%83%83%E3%81%A8%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8%E3%81%97%E3%82%84%E3%81%99%E3%81%84%E3%81%AE%E3%81%AF893%E3%81%AE%E4%BB%A3%E7%B4%8B%E3%81%A8%E8%A6%AA%E5%AD%90%E3%81%AE%E7%9B%83">パッとイメージしやすいのは893の代紋と親子の盃</a></li><li><a href="#%E5%A4%B1%E5%8A%B9%E3%83%AA%E3%82%B9%E3%83%88%E3%81%A8%E7%A0%B4%E9%96%80%E7%8A%B6">失効リストと破門状</a></li></ul></li><li><p><a href="#%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%83%81%E3%82%A7%E3%83%BC%E3%83%B3%E3%81%A8%E3%83%AB%E3%83%BC%E3%83%88%E8%A8%BC%E6%98%8E%E6%9B%B8">証明書チェーンとルート証明書</a></p></li><li><p><a href="#%E3%83%AB%E3%83%BC%E3%83%88%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E7%A2%BA%E3%81%8B%E3%82%89%E3%81%97%E3%81%95">ルート証明書の確からしさ</a></p></li><li><p><a href="#%E3%83%AB%E3%83%BC%E3%83%88%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%8C%E6%9B%B4%E6%96%B0%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E3%81%A8%E3%81%8D%E3%81%AE%E4%BB%A3%E6%9B%BF%E6%89%8B%E6%AE%B5%E3%81%A8%E3%81%AF">ルート証明書が更新できないときの代替手段とは？</a></p></li><li><p><a href="#%E3%82%AF%E3%83%AD%E3%82%B9%E3%83%AB%E3%83%BC%E3%83%88%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">クロスルート証明書について</a></p></li><li><p><a href="#%E8%A9%B1%E3%82%92%E6%88%BB%E3%81%97%E3%81%A6datadog">話を戻してDatadog</a></p></li><li><p><a href="#datadog-agent%E3%81%AFtornado%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B">Datadog AgentはTornadoを使っている</a></p></li><li><p><a href="#%E7%B5%90%E8%AB%96">結論</a></p></li><li><p><a href="#%E8%BF%BD%E8%A8%98">追記</a></p></li></ul></div><h2 id="certificate_verify_failed-は突然に" style="position:relative"><a href="#certificate_verify_failed-%E3%81%AF%E7%AA%81%E7%84%B6%E3%81%AB" aria-label="certificate_verify_failed は突然に permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CERTIFICATE_VERIFY_FAILED は突然に</h2><p>**「ギャー！めっちゃEC2の監視が落ちているんですけど！」**と連絡を受けた土曜日。</p><p>カンパリオレンジならぬカンパリ野菜生活をゴクゴク飲んでいた私は意識朦朧とする中、Slackを見る。</p><p>ギャー!!</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/MQtTdnk.png" alt="img"></p><p>めっちゃ落ちてますね....。</p><p>一通りサービスの状態を見て問題なかったのでこの日は持ち前の「大丈夫ですよ(大嘘)」をかまして眠ることにしました。</p><h2 id="datadogからのアナウンス" style="position:relative"><a href="#datadog%E3%81%8B%E3%82%89%E3%81%AE%E3%82%A2%E3%83%8A%E3%82%A6%E3%83%B3%E3%82%B9" aria-label="datadogからのアナウンス permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Datadogからのアナウンス</h2><p>翌日、Datadogからアナウンスがありました。</p><p><a href="https://docs.datadoghq.com/agent/faq/certificate_verify_failed-error/" target="_blank" rel="noopener noreferrer">CERTIFICATE_VERIFY_FAILED error</a></p><p>サイトを見ると何が起きていて、どんな対応がユーザーに必要かが書いてありました。</p><blockquote><p>On Saturday May 30th, 2020, at 10:48 UTC, an SSL root certificate used to cross-sign some of the Datadog certificates expired, and caused some of your Agents to lose connectivity with Datadog endpoints. Because this root certificate is embedded in certain Agent versions, you will need to take action to restore connectivity.</p></blockquote><p>ふむふむ... <strong>SSLのルート証明書(cross-sign)が失効</strong>してしまいましたわよ、という案件なのですね。</p><p>よくあるSSL証明書失効と何が違うのでしょうか...よくわかりませんね..。</p><p>とりあえずそこら辺の調査は後回しで直していきます。</p><p>いくつかサイトに直し方が書いてありましたが今回は、</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">sudo rm /opt/datadog-agent/agent/datadog-cert.pem &amp;&amp; sudo service datadog-agent restart</code></pre></div><p>の直し方にフォーカスしてみようかと思います。どうやら <strong>datadog-cert.pem</strong> を消してからdatadogの<strong>サービス再起動</strong>すればいいみたい。</p><p>ということで、各EC2に入ってごにょごにょしたら<strong>直りました</strong>。よかった...ホッと...。</p><h2 id="そもそもsslの仕組みをおさらい" style="position:relative"><a href="#%E3%81%9D%E3%82%82%E3%81%9D%E3%82%82ssl%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF%E3%82%92%E3%81%8A%E3%81%95%E3%82%89%E3%81%84" aria-label="そもそもsslの仕組みをおさらい permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>そもそもSSLの仕組みをおさらい</h2><p>直ったのはいいですが、何が起きていたかちゃんと把握したいですよね...。</p><p>ということで5年ぶりにSSLのお勉強をしました。</p><p>といっても私が知っているのは公開鍵暗号の話だけ...ですので実質初学習です。</p><p>公開鍵暗号について詳しく知りたい人は、</p><p><a href="https://amzn.to/3rypnvi" target="_blank" rel="noopener noreferrer"><strong>暗号技術入門 第3版　秘密の国のアリス</strong></a>がいいと思います。</p><p>私をこの業界に引き込んだ師が大学の頃に読め！と言われて買って読んだ記憶があります。</p><p>今でも家の本棚にありました。マジで良書です。わかりやすいです。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/E0GC9w0.jpg" alt="img"></p><p>さて簡単にSSL通信のおさらいをします。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/APQPDxd.png" alt="img"> 引用: <a href="https://ssl.sakura.ad.jp/column/ssl/" target="_blank" rel="noopener noreferrer">https://ssl.sakura.ad.jp/column/ssl/</a></p><p>わかりやすいイラストがさくらのSSLにありましたので拝借します。</p><p>重要なポイントとして、ブラウザ(クライアント)はSSL通信をするときにSSLの通信リクエスト(ClientHello)を送信すると、サーバーから<strong>サーバー証明書</strong>と<strong>公開鍵</strong>が送られてきます。</p><p>暗号通信についてはこのうち<strong>公開鍵</strong>が利用され、クライアント側でランダムな値を<strong>共通鍵のシークレット</strong>として利用することを決定し<strong>公開鍵</strong>を使って暗号化し、サーバーに送信します。</p><p>するとサーバーでは秘密鍵を使って共通鍵が取り出せるのでここから共通鍵暗号(例えばAESとか)での通信ができるわけです。これが<strong>鍵交換</strong>というやつです。</p><p>えっ!?普通に互いの公開鍵を交換して公開鍵暗号で通信すればいいだけじゃんアゼルバイジャンと思ったそこの君!!それは違いますね。</p><p>まず、その場合クライアントに公開鍵と対応する秘密鍵を用意する必要がありますね。あなたは田舎のおばあちゃんにOpenSSLコマンドを打たせるんですか...それはきついですよね。</p><p>もう一つの問題は一般的に公開鍵暗号は共通鍵暗号に比べて暗号コストが高いということです。それなりの桁数の乱数をぶつけていくので共通鍵の<strong>数十～数千倍遅い</strong>といわれてます。</p><p>ちなみにSSLの通信で、出てきた公開鍵暗号や共通鍵暗号のアルゴリズムパターンを定義するのが皆さん大好きおなじみの <strong>Cipher suite</strong>です。</p><p>サイト管理者ならひと昔前、<a href="https://developers.google.com/admob/ios/app-transport-security?hl=ja" target="_blank" rel="noopener noreferrer">ATS対応</a>とかでツライ思いをした人もいるかもしれませんね。</p><p><strong>ECDHE-RSA-AES128-GCM-SHA256</strong> こんなやつ...あぁ...SHA-1の悪夢がよみがえりますね。</p><p>脱線ついでにもう一つ。</p><p>上記で述べた鍵交換一つとってもたとえば<strong>RSA</strong>という方式ではほぼ上記で説明しているとおりの流れを組むのですが、<strong>前方秘匿性</strong>に弱い欠点(一言でいえば全暗号通信を記憶していた状態で秘密鍵を手に入れたらすべてがばれてしまう)があったりで最近ではDHE（DiffieHellman, Ephemeral）という鍵交換方式を楕円曲線暗号上で行なう<strong>ECDHE</strong>（RFC4492）が主流だったりします。</p><p>ここまでのお話はぜひ<a href="https://amzn.to/3rypnvi" target="_blank" rel="noopener noreferrer">暗号技術入門 第3版　秘密の国のアリス</a>を読んでいただければ私なんかよりわかりやすく説明しているので興味がある人はぜひ読んでみましょう!!</p><h2 id="ssl通信におけるサーバー認証とサーバー証明書" style="position:relative"><a href="#ssl%E9%80%9A%E4%BF%A1%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E8%AA%8D%E8%A8%BC%E3%81%A8%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E8%A8%BC%E6%98%8E%E6%9B%B8" aria-label="ssl通信におけるサーバー認証とサーバー証明書 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SSL通信におけるサーバー認証とサーバー証明書</h2><p>SSL通信でもう一つ重要な要素は <strong>なりすまし</strong> <strong>盗聴</strong> <strong>改ざん</strong>を防ぐことです。</p><p>サイトが本物のサイトか、途中に暗号を盗聴しているものはいないか、通信内容を不正に書き換えられていないかをチェックできないとネットショッピングとかで使える安全な暗号通信の意味がありません。</p><p>それを担保する仕組みが<strong>サーバー証明書</strong>となるわけです。</p><p>デジタル証明書も公開鍵暗号の仕組みを応用した話になります。</p><p>サーバー証明書が本物であるかどうかの話の前にサーバー証明書にはどんな情報が書いてあるか見ていきましょう。</p><h3 id="サーバー証明書の中身" style="position:relative"><a href="#%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E4%B8%AD%E8%BA%AB" aria-label="サーバー証明書の中身 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>サーバー証明書の中身</h3><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/r3Rhva4.png" alt="img"></p><p>こちらはAWSのコンソールのSSL通信に使われているサーバー証明書です。</p><p>いろんな情報が書かれているかと思いますがこちらは<a href="https://ja.wikipedia.org/wiki/X.509#.E8.A8.BC.E6.98.8E.E6.9B.B8.E3.81.AE.E6.A7.8B.E9.80.A0" target="_blank" rel="noopener noreferrer">X.509</a>という規格に従って記載されています。</p><p>詳しく知りたい人は<a href="https://ja.wikipedia.org/wiki/X.509#.E8.A8.BC.E6.98.8E.E6.9B.B8.E3.81.AE.E6.A7.8B.E9.80.A0" target="_blank" rel="noopener noreferrer">X.509</a>を確認しましょう！</p><p>簡単にAmazonの証明書の要素列挙しますと、</p><ul><li>バージョン</li></ul><p>: 3</p><ul><li>シリアル番号: 08 18 CC ....</li><li>署名アルゴリズム: RSA暗号化を使用するSHA-256</li><li>発行者</li></ul><p>: Amazon CA 1B</p><ul><li>有効期間<ul><li>開始</li></ul></li></ul><p>: 2020/04/13 9:00:00 JST</p><ul><li>満了</li></ul><p>: 2021/03/15 21:00:00 JST</p><ul><li>主体者</li></ul><p>(サブジェクト)</p><ul><li>ap-northeast-1.console.aws.amazon.com</li><li>主体者の公開鍵情報<ul><li>公開鍵アルゴリズム: RSA暗号化</li><li>主体者の公開鍵: 256バイト: 83 22 EB....</li><li>証明書の署名アルゴリズム: SHA-256 ECDSA</li><li>証明書の署名: 256バイト26 87 E2...</li></ul></li><li>フィンガープリント<ul><li>SHA-256: C0 75 7D...</li><li>SHA-1: CD 63 42...</li></ul></li></ul><p>Amazonが発行し、ドメインがAmazon所有の<strong>ap-northeast-1.console.aws.amazon.com</strong>がつらつらと書かれているわけです。</p><p>他に重要な要素としてサーバー証明書の<strong>有効期限</strong>があります。有効期限切れの証明書は証明書して無効となります。</p><p>基本的にサーバー証明書は有効期限が切れる前に更新しなければいけません。それをやり忘れるのがいわゆる**SSL証明書更新失敗！**というやつです。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/m4xqMek.png" alt="img"></p><p>証明書の有効期限はOpenSSLコマンドで簡単に取れますので、そういうことがないようにZabbixのExternalScriptとかできっちり管理することをおすすめしますー。</p><p>ちなみに下記コマンドで簡単に証明書期限は確認できます。</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">openssl s_client -connect hoge.com:443 -servername blog.tubone-project24.xyz &lt; /dev/null 2> /dev/null | openssl x509 -noout -startdate -enddate

notBefore=Jul  1 00:00:00 2019 GMT
notAfter=Aug 29 12:00:00 2021 GMT</code></pre></div><p>我が家のサーバーのSSL証明書はZabbixで管理してます。(余談)</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/KzVk6D2.png" alt="img"></p><h2 id="認証局" style="position:relative"><a href="#%E8%AA%8D%E8%A8%BC%E5%B1%80" aria-label="認証局 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>認証局</h2><p>しかし、サーバー証明書に書いてある内容は本当に改ざんなく正しいのでしょうか？</p><p>実はサーバー証明書自体はOpenSSLのコマンドでだれでも発行はできてしまいます。(そういうのを俗にオレオレ証明書とか言ったりします)なので証明書自体の確からしさは<strong>別の人</strong>にケツ持ちしてもらうことで担保しましょう！というのがデジタル証明書の認証局という仕組みとなります。</p><p>まずサーバー証明書の中身をハッシュ関数(SHA-256とかそういったやつ)にかけてサーバー証明書固有のハッシュ値を得ます。</p><p>そのハッシュ値に<strong>認証局</strong>というケツ持ちが秘密鍵を使って暗号化処理を行います。</p><p>すると、そのハッシュ値を複合できるのは認証局の公開鍵になるわけです。</p><p>（ちなみに秘密鍵所有者が自身の情報の出所の確からしさを証明するため、秘密鍵で暗号化させ、相手に公開鍵で複合させるという発想が公開鍵暗号を利用したデジタル署名の基本的な考え方です）</p><p>つまり..。</p><p>サーバー証明書の確からしさを確かめるには、</p><ol><li>サーバー証明書のハッシュを得る</li><li>サーバー証明書についている認証局の秘密鍵で暗号化されたハッシュ値を認証局の公開鍵で複合する</li><li>1と2が一致しているか確認する</li></ol><p>という手順を踏むわけです。</p><p><strong>ちなみに認証局の証明書にもちゃんと有効期限が存在します</strong>。ココ重要。</p><h3 id="手順のおさらい" style="position:relative"><a href="#%E6%89%8B%E9%A0%86%E3%81%AE%E3%81%8A%E3%81%95%E3%82%89%E3%81%84" aria-label="手順のおさらい permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>手順のおさらい</h3><p>サーバー証明書作成手順を理解すると実は仕組みがわかりやすいので蛇足ですがコマンド付きで解説します。</p><p>まず、サイト管理者などサーバー証明書を作りたい人はサーバー証明書のタマゴである<strong>C</strong>ertificate <strong>S</strong>igning <strong>R</strong>equest、いわゆる<strong>CSR</strong>をOpenSSLのコマンドとかで作成します。</p><p>作成の際はセキュリティ上OpenSSLが使う疑似乱数をきっちり回しておくことをお勧めします。</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># 疑似乱数作成
./openssl md5 * > rand.dat

# サーバ証明書の暗号化に使う秘密鍵
./openssl genrsa -rand rand.dat -des3 2048 > private.pem

# CSR作成
./openssl req -new -key private.pem -out newcsr.pem

# 証明書の内容について質問されるので答えていく


Country Name (2 letter code) [AU]:JP

State or Province Name (full name) [Some-State]:Tokyo

Locality Name (eg, city) []:Shinjuku-ku

Organization Name (eg, company) [Internet Widgits Pty Ltd]:Tojo-kai

Organizational Unit Name (eg, section) []:Majima-gumi

Common Name (eg, YOUR name) []:yakuza-kusowaru-boryoku.com
</code></pre></div><p>CSRができたらこちらをお近くの認証局(DigiCertとか)に送ると認証局の秘密鍵で署名を暗号化したものをCSRにくっつけたいわゆるサーバー証明書が出来上がります。</p><h3 id="パッとイメージしやすいのは893の代紋と親子の盃" style="position:relative"><a href="#%E3%83%91%E3%83%83%E3%81%A8%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8%E3%81%97%E3%82%84%E3%81%99%E3%81%84%E3%81%AE%E3%81%AF893%E3%81%AE%E4%BB%A3%E7%B4%8B%E3%81%A8%E8%A6%AA%E5%AD%90%E3%81%AE%E7%9B%83" aria-label="パッとイメージしやすいのは893の代紋と親子の盃 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>パッとイメージしやすいのは893の代紋と親子の盃</h3><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/RfBcxD9.png" alt="img"></p><p>893映画やゲームが好きなほうならピンとくるかもしれませんが、認証局って893の<strong>代紋</strong>みたいなもんなんですね。</p><p>晴れてあなたが組の長になったとき、その組の正当性や所属を明らかにするために後ろ盾の組の代紋飾るじゃないですか。</p><p>もちろんただでは代紋なんて飾れないので<strong>親子の盃</strong>を交わすことで許可がでるわけですが、これがCSRを認証局に提出すると思ってください。</p><p>晴れて、代紋をいただければあとは好きに暴れて結構。(ダメ)</p><p>まとめると代紋というのはいわゆる上位の組が下位の組を認証しているんですね！だからビジネスができるわけですね。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/30262FQ.png" alt="img"></p><h3 id="失効リストと破門状" style="position:relative"><a href="#%E5%A4%B1%E5%8A%B9%E3%83%AA%E3%82%B9%E3%83%88%E3%81%A8%E7%A0%B4%E9%96%80%E7%8A%B6" aria-label="失効リストと破門状 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>失効リストと破門状</h3><p>余談ですが、証明書には<strong>失効リスト</strong>というものがあります。</p><p>認証局が発行した証明書は基本的には認証局自体のもしくはサーバー証明書の有効期限まで効力を持ちます。</p><p>ただ、秘密鍵が流出したり、認証したサーバーが悪いことばかりやったりとで有効期限関係なく、　 認証局の効力をなくしたい場合があります。</p><p>その時使えるのが<strong>C</strong>ertificate <strong>R</strong>evocation <strong>L</strong>ist(<strong>CRL</strong>)です。失効リストでRevokeとしたサーバー証明書は認証局の署名効力を失います。これは認証局で行なうことができます。</p><p>これって893でいうところの<strong>破門状</strong>ですよね..。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/f382RVO.jpg" alt="img"></p><p>破門状のいい画像がなかったし、本物の破門状を載せるのもどうかと思ったので勝手に<a href="https://lineblog.me/ozawahitoshi/archives/1027317703.html" target="_blank" rel="noopener noreferrer">小沢仁志オフィシャルブログ</a>から借りてきました。</p><p>破門状は893の死刑宣告といわれてますが、まさに失効リストはサーバー証明書の死刑宣告なのです。</p><h2 id="証明書チェーンとルート証明書" style="position:relative"><a href="#%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%83%81%E3%82%A7%E3%83%BC%E3%83%B3%E3%81%A8%E3%83%AB%E3%83%BC%E3%83%88%E8%A8%BC%E6%98%8E%E6%9B%B8" aria-label="証明書チェーンとルート証明書 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>証明書チェーンとルート証明書</h2><p>今度はこのブログのサーバー証明書を確認してみましょう。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/oh5oyKC.png" alt="img"></p><p>このブログのドメインである<a href="https://blog.tubone-project24.xyz" target="_blank" rel="noopener noreferrer">blog.tubone-project24.xyz</a>が確かに所有しているドメインとなっているわけですが認証局は<strong>Let's Encrypt Authority X3</strong>ですね。</p><p>では<strong>Let's Encrypt Authority X3</strong>が本物の認証局かどうかはどうやって判断するのでしょうか？</p><p>この仕組みが<strong>証明書チェーン</strong>です。</p><p>実は先ほどのAWSの証明書もそうでしたがチェーンは簡単に追うことができます。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/wDLRAKk.png" alt="img"></p><p>赤枠がチェーンです。</p><p><strong>Let's Encrypt Authority X3</strong>の証明書を見てみましょう。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/gpaXTQe.png" alt="img"></p><p><strong>Let's Encrypt Authority X3</strong>のケツ持ちはどうやら<strong>DST Root CA X3</strong>がやっているみたいですね。</p><p>このように<strong>認証局を別の認証局にケツ持ち</strong>してもらうことができます。</p><p>さらにチェーンを追ってみます。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/m8zYyuz.png" alt="img"></p><p><strong>DST Root CA X3</strong>のケツ持ちは<strong>DST Root CA X3</strong>ですね...????ん????</p><p>これはどういうことかというと言葉通り、<strong>DST Root CA X3</strong>のケツ持ちは<strong>DST Root CA X3</strong>がやっているということです。</p><p>証明書チェーンではそれ以上、上位の認証局がいない証明書が必ず出てきます。これが<strong>ルート証明書</strong>というやつです。</p><p>ルート証明書はそれ以上認証してくれるケツ持ちがいないのでクライアントは盲目的に信頼する必要があります。</p><p>えっ！それでいいの？という声が聞こえてきますね...。</p><h2 id="ルート証明書の確からしさ" style="position:relative"><a href="#%E3%83%AB%E3%83%BC%E3%83%88%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E7%A2%BA%E3%81%8B%E3%82%89%E3%81%97%E3%81%95" aria-label="ルート証明書の確からしさ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ルート証明書の確からしさ</h2><p>ではサーバー証明書にチェーンされるルート証明書はどのように確からしさをチェックすればいいのでしょうか？</p><p>それは、PCを買ったときやブラウザを入れたときにルート証明書をクライアントそばに入れておいて<strong>共通のルート証明書を持ったサーバー証明書を検証</strong>する仕組みとしているわけです。</p><p>Macだとインストールされているルート証明書を<strong>キーチェーン</strong>から確認できます。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/VGk9uYk.png" alt="img"></p><p>当然ルート証明書にも有効期限があります。</p><p>ルート証明書の有効期限が切れないようにOSの定期アップデートやブラウザのバージョンが更新タイミングで最新の証明書がインストールされる寸法になっています。</p><h2 id="ルート証明書が更新できないときの代替手段とは" style="position:relative"><a href="#%E3%83%AB%E3%83%BC%E3%83%88%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%8C%E6%9B%B4%E6%96%B0%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E3%81%A8%E3%81%8D%E3%81%AE%E4%BB%A3%E6%9B%BF%E6%89%8B%E6%AE%B5%E3%81%A8%E3%81%AF" aria-label="ルート証明書が更新できないときの代替手段とは permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ルート証明書が更新できないときの代替手段とは？</h2><p>そうはいってもデバイスがインターネットにつながっていなかったり、組み込み端末などたくさんのルート証明書をインストールする余裕がない場合などあるかと思います。</p><p>そういった場合たくさんのルート証明書を検証することはおろか、期限が迫っている証明書更新もできません。</p><p>そういった場合はどうやってルート証明書を使うのでしょうか？</p><h2 id="クロスルート証明書について" style="position:relative"><a href="#%E3%82%AF%E3%83%AD%E3%82%B9%E3%83%AB%E3%83%BC%E3%83%88%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6" aria-label="クロスルート証明書について permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>クロスルート証明書について</h2><p>そんなときに<strong>クロスルート証明書</strong>です。</p><p>ルート証明書を更新できなかったり、複数のルート証明書をまとめあげるために使います。</p><p>例えば下記の証明書チェーンがあったとします。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/JcUkWaJ.png" alt="img"></p><p>ラーメン食べている人が<a href="https://blog.tubone-project24.xyz" target="_blank" rel="noopener noreferrer">blog.tubone-project24.xyz</a>にアクセスする際のチェーンは<strong>中間証明書A</strong>から<strong>ルート証明書A</strong>をたどって自身の端末にあるルート証明書の検証します。</p><p>ではルート証明書が更新された場合はいかがでしょうか？</p><p>通常端末のアップデートなどでクライアント側のルート証明書も更新されますので、</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/1uF5dA3.png" alt="img"></p><p>と新しい<strong>ルート証明書B</strong>を使うことになりますね。</p><p>ではさらにこの端末がアップデートできない場合やインストールしてないルート証明書へアクセスする場合はどうなるでしょうか？</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/y0ul2Eg.png" alt="img"></p><p>はい。当然ダメですね..。</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">(･ω･乂)
(乂･ω･)
(･ω･乂)
(乂･ω･)</code></pre></div><p><a href="https://blog.tubone-project24.xyz" target="_blank" rel="noopener noreferrer">blog.tubone-project24.xyz</a>のサーバー証明書の中間証明書から先のルート証明書はルート証明書Bなので<strong>自端末に存在しないルート証明書</strong>になってしまいます。</p><p>これを解決するのが<strong>クロスルート証明書</strong>というわけです。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/9fwz8jM.png" alt="img"></p><p>クロスルート証明書を使った場合、仮にあなたの端末にルート証明書Aしかない場合、<a href="https://blog.tubone-project24.xyz" target="_blank" rel="noopener noreferrer">blog.tubone-project24.xyz</a>へのアクセスをするとサーバー証明書から中間証明書をまずチェーンします。</p><p>そのまま上のルート証明書を見てもこちら残念ながらさっきと同じなのですが中間証明書に紐づくクロスルート証明書というものがありこちらが内容はルート証明書Bと同じながらルート証明書Aで署名されている形を取ります。すると、クロスルート証明書からルート証明書Aをたどって検証が完了するわけです。</p><p>えっ？中間証明書を複数のルート証明書で署名するみたいなそんなことできるんですか..?という疑問が出たそこの君！優秀ですね。</p><p>クロスルート方式を利用する場合には、中間証明書とクロスルート設定証明書を連結させて1つにした中間証明書として利用することで上記の通りになります。</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">—–BEGIN CERTIFICATE—–
  中間CA証明書の文字列
—–END CERTIFICATE—–
—–BEGIN CERTIFICATE—–
  クロスルート設定用証明書の文字列
—–END CERTIFICATE—–</code></pre></div><p>レガシー端末や組み込み系ではこのような方法を利用してルート証明書の管理をしているわけです。</p><h2 id="話を戻してdatadog" style="position:relative"><a href="#%E8%A9%B1%E3%82%92%E6%88%BB%E3%81%97%E3%81%A6datadog" aria-label="話を戻してdatadog permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>話を戻してDatadog</h2><p>さて話を戻してDatadogのコードに移ります。</p><p>さきほども申したとおり、通常ルート証明書はPC側のアップデートに追従して更新されていくのでそこまで気になりませんが、この手の<strong>エージェントやJDK</strong>などは独自にルート証明書を抱えていて、それを使うようにする場合も多いです。</p><p>脱線しますが、たとえばJDKとかではJavaが使うルート証明書を<strong>cacerts</strong>に格納します。</p><p>例えば<strong>OpenJDK1.8.0</strong>の場合、Macなら、</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">lib/jvm/java-1.8.0-openjdk-1.8.0.201.b09-2.el7_6.x86_64/jre/lib/security/cacerts</code></pre></div><p>にcacertsがいます。</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ keytool -keystore cacerts -list -v</code></pre></div><p>というコマンドでJDKにインストールされているルート証明書が確認できます。</p><p>なんか回りくどいですがこうすることでJavaプロセス単体でSSL通信の検証ができるわけで<strong>30億のデバイスで走る</strong>ことができるわけですね。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/zKzF2Wa.jpg" alt="img"></p><blockquote><p>30億のデバイスで走るのに自分の環境では走らないJava</p></blockquote><p>(とか揶揄されたことありましたね。余談です。)</p><p>DatadogもまさにJDKと同じような実装でした。</p><p>ちなみに今回有効期限の切れた証明書はDatadogのサイト<a href="https://docs.datadoghq.com/agent/faq/certificate_verify_failed-error/" target="_blank" rel="noopener noreferrer"><strong>CERTIFICATE_VERIFY_FAILED error</strong> </a>や本事象のdatadog-agent修正PRの<a href="https://github.com/DataDog/dd-agent/pull/3882" target="_blank" rel="noopener noreferrer">Update the Sectigo / USERTrust CA Certificate #3882</a>に書いてある情報から判明しており、<a href="https://support.sectigo.com/articles/Knowledge/Sectigo-AddTrust-External-CA-Root-Expiring-May-30-2020" target="_blank" rel="noopener noreferrer"><strong>Sectigo AddTrust External CA Root</strong></a>が<strong>2020/5/30</strong>に失効しました。</p><h2 id="datadog-agentはtornadoを使っている" style="position:relative"><a href="#datadog-agent%E3%81%AFtornado%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B" aria-label="datadog agentはtornadoを使っている permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Datadog AgentはTornadoを使っている</h2><p>そもそも<a href="https://docs.datadoghq.com/ja/agent/" target="_blank" rel="noopener noreferrer">Datadog Agent</a>というのはEC2などの監視対象サーバーにサービスの形で常駐させるとCPUやディスクのメトリックを取得し、Datadogに送信してくれるやつです。</p><p>Zabbix AgentのDatadog版ですね。</p><p>Datadogへメトリックを送信しなければいけないので当然インターネット越しに通信をしなければいけません。もちろん通信はSSLで暗号化されてしかるべきです。</p><p>これは知らなかったのですがDatadog Agentって<a href="https://www.tornadoweb.org/en/stable/index.html" target="_blank" rel="noopener noreferrer">Tornado</a>を使っています。</p><p>datadog-agent(version 5)をサービス起動するとlocalhostのport17123にTornadoのサーバーが立ち上がります。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/Z58AGfp.jpg" alt="img"></p><p>この**Tornadoサーバー(Forwarder)**にmetricsのcollectorが収集した情報を投げ込むことでDatadogサーバーへmetricsをForwardingしてくれる仕組みのようです。</p><p>こうすることでDatadog謹製のcollectorだけでなくDogStatusD経由でcustom metricsも効率的に収集できます。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/q1Ouk6Y.png" alt="img"></p><p>詳しくはdatadog-agentのGitHub<a href="https://github.com/DataDog/dd-agent" target="_blank" rel="noopener noreferrer">https://github.com/DataDog/dd-agent</a>や、</p><p><a href="https://docs.datadoghq.com/ja/agent/basic_agent_usage/?tab=agentv5" target="_blank" rel="noopener noreferrer">Agent アーキテクチャ</a></p><p>をご覧ください。</p><p>さてこのTornadoで実際にDatadogと通信しているところはシーケンス図上の<strong>Tornado HttpClient</strong>、正確には<a href="https://www.tornadoweb.org/en/stable/httpclient.html" target="_blank" rel="noopener noreferrer">Asynchronous HTTP client</a>になるわけですが、datadog-agentの作りとして、Asynchronous HTTP clientに独自でca_certsを設定し、Datadogとの通信に<strong>datadog-cert.pem</strong>というクロスルート証明書を使っております。</p><p>では<strong>datadog-cert.pem</strong>を見てみましょう。</p><p>確認にはOpenSSLコマンドが利用できます。</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ openssl x509 -text -noout -in datadog-cert.pem                                                                                   
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 1 (0x1)
        Signature Algorithm: sha1WithRSAEncryption
        Issuer: C = SE, O = AddTrust AB, OU = AddTrust External TTP Network, CN = AddTrust External CA Root
        Validity
            Not Before: May 30 10:48:38 2000 GMT
            Not After : May 30 10:48:38 2020 GMT
        Subject: C = SE, O = AddTrust AB, OU = AddTrust External TTP Network, CN = AddTrust External CA Root
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (2048 bit)
                Modulus:
                    00:b7:f7:1a:33:e6:f2:00:04:2d:39:e0:4e:5b:ed:
                    1f:bc:6c:0f:cd:b5:fa:23:b6:ce:de:9b:11:33:97:
                    a4:29:4c:7d:93:9f:bd:4a:bc:93:ed:03:1a:e3:8f:
                    cf:e5:6d:50:5a:d6:97:29:94:5a:80:b0:49:7a:db:
                    2e:95:fd:b8:ca:bf:37:38:2d:1e:3e:91:41:ad:70:
                    56:c7:f0:4f:3f:e8:32:9e:74:ca:c8:90:54:e9:c6:
                    5f:0f:78:9d:9a:40:3c:0e:ac:61:aa:5e:14:8f:9e:
                    87:a1:6a:50:dc:d7:9a:4e:af:05:b3:a6:71:94:9c:
                    71:b3:50:60:0a:c7:13:9d:38:07:86:02:a8:e9:a8:
                    69:26:18:90:ab:4c:b0:4f:23:ab:3a:4f:84:d8:df:
                    ce:9f:e1:69:6f:bb:d7:42:d7:6b:44:e4:c7:ad:ee:
                    6d:41:5f:72:5a:71:08:37:b3:79:65:a4:59:a0:94:
                    37:f7:00:2f:0d:c2:92:72:da:d0:38:72:db:14:a8:
                    45:c4:5d:2a:7d:b7:b4:d6:c4:ee:ac:cd:13:44:b7:
                    c9:2b:dd:43:00:25:fa:61:b9:69:6a:58:23:11:b7:
                    a7:33:8f:56:75:59:f5:cd:29:d7:46:b7:0a:2b:65:
                    b6:d3:42:6f:15:b2:b8:7b:fb:ef:e9:5d:53:d5:34:
                    5a:27
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Subject Key Identifier:
                AD:BD:98:7A:34:B4:26:F7:FA:C4:26:54:EF:03:BD:E0:24:CB:54:1A
            X509v3 Key Usage:
                Certificate Sign, CRL Sign
            X509v3 Basic Constraints: critical
                CA:TRUE
            X509v3 Authority Key Identifier:
                keyid:AD:BD:98:7A:34:B4:26:F7:FA:C4:26:54:EF:03:BD:E0:24:CB:54:1A
                DirName:/C=SE/O=AddTrust AB/OU=AddTrust External TTP Network/CN=AddTrust External CA Root
                serial:01
    Signature Algorithm: sha1WithRSAEncryption
         b0:9b:e0:85:25:c2:d6:23:e2:0f:96:06:92:9d:41:98:9c:d9:
         84:79:81:d9:1e:5b:14:07:23:36:65:8f:b0:d8:77:bb:ac:41:
         6c:47:60:83:51:b0:f9:32:3d:e7:fc:f6:26:13:c7:80:16:a5:
         bf:5a:fc:87:cf:78:79:89:21:9a:e2:4c:07:0a:86:35:bc:f2:
         de:51:c4:d2:96:b7:dc:7e:4e:ee:70:fd:1c:39:eb:0c:02:51:
         14:2d:8e:bd:16:e0:c1:df:46:75:e7:24:ad:ec:f4:42:b4:85:
         93:70:10:67:ba:9d:06:35:4a:18:d3:2b:7a:cc:51:42:a1:7a:
         63:d1:e6:bb:a1:c5:2b:c2:36:be:13:0d:e6:bd:63:7e:79:7b:
         a7:09:0d:40:ab:6a:dd:8f:8a:c3:f6:f6:8c:1a:42:05:51:d4:
         45:f5:9f:a7:62:21:68:15:20:43:3c:99:e7:7c:bd:24:d8:a9:
         91:17:73:88:3f:56:1b:31:38:18:b4:71:0f:9a:cd:c8:0e:9e:
         8e:2e:1b:e1:8c:98:83:cb:1f:31:f1:44:4c:c6:04:73:49:76:
         60:0f:c7:f8:bd:17:80:6b:2e:e9:cc:4c:0e:5a:9a:79:0f:20:
         0a:2e:d5:9e:63:26:1e:55:92:94:d8:82:17:5a:7b:d0:bc:c7:
         8f:4e:86:04</code></pre></div><p>﻿ 確かに有効期限は切れてますね。</p><p>sectigoのサイトによい図があったので拝借しますが、このようなチェーンをする証明書のようです。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/oMJmF1b.jpg" alt="img"></p><p>Modern Browser側の動きでは最新の<strong>USERTrust RSA</strong>のルート証明書から検証ができますが、Legacy(Datadogもこっち)Browserは<strong>AddTrust External CA Root</strong>までチェーンしております。</p><p>上記のdatadog-cert.pemのCN(CommonName)を見ても確かにAddTrust External CA Rootですね。</p><p>よって2020/5/30～SSL通信できなくなってしまったというわけです。</p><h2 id="結論" style="position:relative"><a href="#%E7%B5%90%E8%AB%96" aria-label="結論 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>結論</h2><p>証明書周りでこれほど調べたのは久しぶりです...。</p><h2 id="追記" style="position:relative"><a href="#%E8%BF%BD%E8%A8%98" aria-label="追記 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>追記</h2><p>JDKにインストールされているルート証明書も気になったので調べたら、OpenJDK9(JEP319)のルート証明書にAddTrust External CA Rootがいました。</p><p><img class="lozad" src="data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7" data-src="https://i.imgur.com/yn4VUB3.png" alt="img"></p><p><a href="https://openjdk.java.net/jeps/319" target="_blank" rel="noopener noreferrer">https://openjdk.java.net/jeps/319</a></p><p>ルート証明書の罠に引っかからないようにみんなも気を付けよう！</p></div><div class="s_0"><h2>tubone24にラーメンを食べさせよう！</h2><p>ぽちっとな↓</p><a href="https://www.buymeacoffee.com/tubone24"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a ramen&amp;emoji=🍜&amp;slug=tubone24&amp;button_colour=40DCA5&amp;font_colour=ffffff&amp;font_family=Lato&amp;outline_colour=000000&amp;coffee_colour=FFDD00" alt="Buy me a ramen"></a></div><div class="t_2"><h2><span class="icon-newspaper-o"></span> Related Posts</h2></div></main><div role="application" data-testid="share-box" class="r_V"><a href="https://www.facebook.com/sharer/sharer.php?u=https://blog.tubone-project24.xyz/2020/06/01/ssl-cert" title="FacebookでShareする" target="_blank" rel="noopener noreferrer" data-testid="facebook-link" class="r_W"><span class="icon-facebook"></span></a><a href="https://twitter.com/intent/tweet?text=LikeThis:&amp;url=https://blog.tubone-project24.xyz/2020/06/01/ssl-cert" title="TwitterでShareする" target="_blank" rel="noopener noreferrer" data-testid="twitter-link" class="r_W"><span class="icon-twitter"></span></a><a href="http://getpocket.com/edit?url=https://blog.tubone-project24.xyz/2020/06/01/ssl-cert" title="Pocketに追加する" target="_blank" rel="noopener noreferrer" data-testid="pocket-link" class="r_W"><span class="icon-get-pocket"></span></a><a href="http://b.hatena.ne.jp/add?mode=confirm&amp;url=https://blog.tubone-project24.xyz/2020/06/01/ssl-cert" data-hatena-bookmark-layout="vertical-normal" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加" data-testid="hatebu-link" target="_blank" rel="noopener noreferrer" class="r_X"><img src="/assets/button-only@2x.png" alt="hatena bookmark" width="30" height="30"></a><a href="#gitalk-container" title="コメントする" data-testid="CommentButton" class="r_W r_Y"><span class="icon-comment"></span></a><a href="#header" title="トップに戻る" data-testid="GotoTopButton" class="r_W r_Z"><span class="icon-chevron-up"></span></a></div></div></div></div></div><footer class="footer y_5"><div class="container"><div class="row"><div class="col-sm-12 text-center"><p data-testid="architecture">Build with <a href="https://www.gatsbyjs.com/" rel="external nofollow noopener" target="_blank">GatsbyJS</a> and <a href="https://preactjs.com/" rel="external nofollow noopener" target="_blank">PReact</a>. Hosted on <a href="https://www.netlify.com/" rel="external nofollow noopener" target="_blank">Netlify</a>. Also indexed posts with <a href="https://www.algolia.com/" rel="external nofollow noopener" target="_blank">Algolia</a></p><p data-testid="copyright" class="y_6">Copyright <a href="https://portfolio.tubone-project24.xyz/" rel="external nofollow noopener" target="_blank">©tubone24</a> <b><a href="/">tubone BOYAKI</a> </b>2017-2022  <a href="/privacy-policies">Privacy Policies</a>  Here is  <a href="/sitemap-index.xml" title="sitemap">Sitemap</a></p></div></div></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script src="https://platform.twitter.com/widgets.js"></script><script src="https://www.instagram.com/embed.js"></script><script src="https://embedr.flickr.com/assets/client-code.js"></script><script src="https://embed.redditmedia.com/widgets/platform.js"></script><script id="gatsby-script-loader">window.pagePath="/2020/06/01/ssl-cert",window.___webpackCompilationHash="0ab08606e28cfb1477c5"</script><script id="gatsby-chunk-mapping">window.___chunkMapping={polyfill:["/polyfill-3d43bfa093fe6c1b2af5.js"],app:["/app-990b78810be6f64c2c6d.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-70145c58a97d7702a1a3.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-07233ae487b5e4c34855.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx-9ad4c7465a6ff4e9c130.js"],"component---src-pages-privacy-policies-tsx":["/component---src-pages-privacy-policies-tsx-f0e4b5b6568304f332a8.js"],"component---src-pages-tags-tsx":["/component---src-pages-tags-tsx-dca5d172b2b88fb1dcce.js"],"component---src-templates-blog-post-tsx":["/component---src-templates-blog-post-tsx-baa1bad61434d13be814.js"],"component---src-templates-index-tsx":["/component---src-templates-index-tsx-17151d85bb35368283b0.js"],"component---src-templates-period-summary-tsx":["/component---src-templates-period-summary-tsx-a7a8f7d81cd2dd439159.js"],"component---src-templates-tag-tsx":["/component---src-templates-tag-tsx-097789018469e3f7946e.js"]}</script><script src="/polyfill-3d43bfa093fe6c1b2af5.js" nomodule></script><script src="/app-990b78810be6f64c2c6d.js" async></script><script src="/dc6a8720040df98778fe970bf6c000a41750d3ae-900bba13b53b9496665a.js" async></script><script src="/6177e270-0fcce1b3afbe0b060aff.js" async></script><script src="/framework-b494fd0cf8cbafcf4f1f.js" async></script><script src="/webpack-runtime-9e9579efcfc703071fb7.js" async></script></body></html>
{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2017/07/11/rlang","result":{"data":{"content":{"edges":[{"node":{"id":"70e9cd18-f719-530e-a041-85aebca9cbdb","excerpt":"…","fields":{"slug":"2017/07/11/rlang"},"frontmatter":{"id":null,"title":"R言語を使って、サポートベクターとかニューラルネットとかを比較してみる（kddcup99編）","slug":"2017/07/11/rlang","date":"2017-07-10T16:29:15.245Z","headerImage":"https://i.imgur.com/Ylygrrb.png","tags":["R言語","機械学習","kddcup99"]}}}]}},"pageContext":{"id":"70e9cd18-f719-530e-a041-85aebca9cbdb","index":102,"repHtml":"<p><strong>機械学習で彼女を作ろうとかふまじめなことはやめよう！</strong></p>\n<p>どうも。最近暑くてどうにもやる気がでませんが、そんなとき、めんどくさいことを機械がやってくれればなと思うわけです。</p>\n<p>最近（とは言ってもだいぶ成熟した分野ですが）流行の機械学習を勉強することによって、明るい未来を作ろうということを考えるわけです。</p>\n<p><a href=\"https://blog.tubone-project24.xyz/2017/06/04/chainer-chieri-bot\" target=\"_blank\" rel=\"noopener noreferrer\">前回</a>はおしゃべり彼女を作りましたので、今回はまじめにセキュリティ系のネタをやっていこうかと思います。</p>\n<h2 id=\"table-of-contents\" style=\"position:relative;\"><a href=\"#table-of-contents\" aria-label=\"table of contents permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Table of Contents</h2>\n<div class=\"toc\">\n<ul>\n<li>\n<p><a href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%82%92%E7%94%A8%E6%84%8F%E3%81%97%E3%82%88%E3%81%86\">データセットを用意しよう</a></p>\n</li>\n<li>\n<p><a href=\"#%E3%81%9F%E3%81%BE%E3%81%AB%E3%81%AFr%E8%A8%80%E8%AA%9E%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86\">たまにはR言語を使ってみよう</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%88%86%E9%A1%9E%E3%81%AB%E3%81%AF%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88%E3%83%99%E3%82%AF%E3%82%BF%E3%83%BC%E3%83%9E%E3%82%B7%E3%83%B3svm\">分類にはサポートベクターマシン（SVM）</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%AE%9F%E9%9A%9B%E3%81%AB%E3%82%84%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%9Fc-svm\">実際にやってみた(C-SVM)</a></p>\n<ul>\n<li><a href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%82%80\">データを読み込む</a></li>\n<li><a href=\"#svm%E3%81%A7%E5%AD%A6%E7%BF%92%E3%81%95%E3%81%9B%E3%82%8B\">SVMで学習させる</a></li>\n<li><a href=\"#%E8%A9%95%E4%BE%A1%E3%81%99%E3%82%8B\">評価する</a></li>\n<li><a href=\"#%E8%A1%A8%E3%81%A7%E3%81%BE%E3%81%A8%E3%82%81%E3%81%BE%E3%81%99\">表でまとめます</a></li>\n<li><a href=\"#%E5%AE%9F%E9%9A%9B%E3%81%AB%E3%82%84%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%9Fc-svm%E3%81%A7%E3%82%AF%E3%83%AD%E3%82%B9%E3%83%90%E3%83%AA%E3%83%87%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3\">実際にやってみた(C-SVMでクロスバリデーション)</a></li>\n<li><a href=\"#%E5%AD%A6%E7%BF%92%E3%81%95%E3%81%9B%E3%82%8Bc-svm-closs3\">学習させる(C-SVM closs=3)</a></li>\n<li><a href=\"#%E8%A9%95%E4%BE%A1%E3%81%99%E3%82%8B-1\">評価する</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%A9%E3%83%AB%E3%83%8D%E3%83%83%E3%83%88%E3%81%A7%E3%82%82%E3%82%84%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%BE%E3%81%99nnet\">ニューラルネットでもやってみます(nnet)</a></p>\n<ul>\n<li><a href=\"#%E5%AD%A6%E7%BF%92%E3%81%95%E3%81%9B%E3%82%8Bnnnet\">学習させる(nnnet)</a></li>\n<li><a href=\"#%E8%A9%95%E4%BE%A1%E3%81%99%E3%82%8B-2\">評価する</a></li>\n<li><a href=\"#%E8%A1%A8%E3%81%A7%E3%81%BE%E3%81%A8%E3%82%81%E3%81%BE%E3%81%99-1\">表でまとめます</a></li>\n<li><a href=\"#%E3%81%8A%E3%81%BE%E3%81%91-%E3%81%9D%E3%82%8C%E3%81%9E%E3%82%8C%E3%81%AE%E3%83%8E%E3%83%BC%E3%83%89%E3%81%AE%E9%87%8D%E3%81%BF%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B\">おまけ それぞれのノードの重みを確認する</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E7%B5%90%E8%AB%96\">結論</a></p>\n<ul>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<h2 id=\"データセットを用意しよう\" style=\"position:relative;\"><a href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%82%92%E7%94%A8%E6%84%8F%E3%81%97%E3%82%88%E3%81%86\" aria-label=\"データセットを用意しよう permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>データセットを用意しよう</h2>\n<p>データセットは以下のものを使います。</p>\n<p><a href=\"http://kdd.ics.uci.edu/databases/kddcup99/kddcup99.html\" target=\"_blank\" rel=\"noopener noreferrer\">KDD Cup 1999 Data</a></p>\n<p>国際会議SIGKDDの1999年のデータマイニングコンペデータだそうで、そのときの侵入検知データはセキュリティ界隈ではかなり有名だそうです。私は最近まで知りませんでした。恥ずかしい。</p>\n<p>このデータはかなり膨大なので、今回はフルデータを10%抽出したkddcup.data_10_percentをさらに学習データと評価データにわけて実験します。</p>\n<p>今回は通常の通信と、いくつかの攻撃手法とを分類します。</p>\n<h2 id=\"たまにはr言語を使ってみよう\" style=\"position:relative;\"><a href=\"#%E3%81%9F%E3%81%BE%E3%81%AB%E3%81%AFr%E8%A8%80%E8%AA%9E%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86\" aria-label=\"たまにはr言語を使ってみよう permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>たまにはR言語を使ってみよう</h2>\n<p>R言語と聞くとじんま疹が出る生物系の学生も多いと思いますが、きちんとPythonとかでプログラミングするよりは簡単だと思います。無料だし。まぁSPSSとかの方がずっと簡単ですが。</p>\n<h2 id=\"分類にはサポートベクターマシンsvm\" style=\"position:relative;\"><a href=\"#%E5%88%86%E9%A1%9E%E3%81%AB%E3%81%AF%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88%E3%83%99%E3%82%AF%E3%82%BF%E3%83%BC%E3%83%9E%E3%82%B7%E3%83%B3svm\" aria-label=\"分類にはサポートベクターマシンsvm permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>分類にはサポートベクターマシン（SVM）</h2>\n<p>機械学習のパターン認識（分類）にはサポートベクターマシン(SVM)がいいと言われています。SVM自体は比較的古い手法ですが、汎化性能を高める工夫がしっかりしている点で非常に未学習データの認識が優れていると言われています。</p>\n<p>R言語ではKernlabというパッケージにSVMがあります。</p>\n<h2 id=\"実際にやってみたc-svm\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E9%9A%9B%E3%81%AB%E3%82%84%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%9Fc-svm\" aria-label=\"実際にやってみたc svm permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実際にやってみた(C-SVM)</h2>\n<h3 id=\"データを読み込む\" style=\"position:relative;\"><a href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%82%80\" aria-label=\"データを読み込む permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>データを読み込む</h3>\n<p>CSV形式のデータですのでReadCSVで読み込み、データ型を再定義した後、攻撃手法をざっくりとした分類に分けます。</p>\n<p>最後のカラムのLabelが攻撃手法を定義したものですが、量が多いので、<a href=\"http://archive.ics.uci.edu/ml/databases/kddcup99/task.html\" target=\"_blank\" rel=\"noopener noreferrer\">ここ</a>を参考に4つの攻撃手法に分けておきます。5クラス分類問題となります。</p>\n<ul>\n<li>DOS</li>\n<li>R2L(リモートからの不正ログイン試み)</li>\n<li>U2R(Root権限奪取)</li>\n<li>Probe(調査)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># CSVとして読み込み\n\n> kddcup &lt;- read_csv(\"~/Downloads/kdd.ics.uci.edu/databases/kddcup99/kddcup.data_10_percent\", header=F)\n\n# ヘッダーをつける\n\n> colnames(kddcup)&lt;-c(\"duration\",\"protocol_type\",\"service\",\"flag\",\"src_bytes\",\"dst_bytes\",\"land\",\"wrong_fragment\",\"urgent\",\"hot\",\"num_failed_logins\",\"logged_in\",\"num_compromised\",\"root_shell\",\"su_attempted\",\"num_root\",\"num_file_creations\",\"num_shells\",\"num_access_files\",\"num_outbound_cmds\",\"is_host_login\",\"is_guest_login\",\"count\",\"srv_count\",\"serror_rate\",\"srv_serror_rate\",\"rerror_rate\",\"srv_rerror_rate\",\"same_srv_rate\",\"diff_srv_rate\",\"srv_diff_host_rate\",\"dst_host_count\",\"dst_host_srv_count\",\"dst_host_same_srv_rate\",\"dst_host_diff_srv_rate\",\"dst_host_same_src_port_rate\",\"dst_host_srv_diff_host_rate\",\"dst_host_serror_rate\",\"dst_host_srv_serror_rate\",\"dst_host_rerror_rate\",\"dst_host_srv_rerror_rate\",\"label\")\n\n# データを整える\n\n> kddcup$duration = as.numeric(as.character(kddcup$duration))\n> kddcup$protocol_type = factor(kddcup$protocol_type)\n> kddcup$service = factor(kddcup$service)\n> kddcup$flag = factor(kddcup$flag)\n> kddcup$src_bytes = as.numeric(as.character(kddcup$src_bytes))\n> kddcup$dst_bytes = as.numeric(as.character(kddcup$dst_bytes))\n> kddcup$land = factor(kddcup$land)\n> kddcup$wrong_fragment = as.numeric(as.character(kddcup$wrong_fragment))\n> kddcup$urgent = as.numeric(as.character(kddcup$urgent))\n> kddcup$hot = as.numeric(as.character(kddcup$hot))\n> kddcup$num_failed_logins = as.numeric(as.character(kddcup$num_failed_logins))\n> kddcup$logged_in = factor(kddcup$logged_in)\n> kddcup$num_compromised = as.numeric(as.character(kddcup$num_compromised))\n> kddcup$root_shell = factor(kddcup$root_shell)\n> kddcup$su_attempted = factor(kddcup$su_attempted)\n> kddcup$num_root = as.numeric(as.character(kddcup$num_root))\n> kddcup$num_file_creations = as.numeric(as.character(kddcup$num_file_creations))\n> kddcup$num_shells = as.numeric(as.character(kddcup$num_shells))\n> kddcup$num_access_files = as.numeric(as.character(kddcup$num_access_files))\n> kddcup$is_guest_login = factor(kddcup$is_guest_login)\n> kddcup$count = as.numeric(as.character(kddcup$count))\n> kddcup$srv_count = as.numeric(as.character(kddcup$srv_count))\n> kddcup$serror_rate = as.numeric(as.character(kddcup$serror_rate))\n> kddcup$srv_serror_rate = as.numeric(as.character(kddcup$srv_serror_rate))\n> kddcup$rerror_rate = as.numeric(as.character(kddcup$rerror_rate))\n> kddcup$srv_rerror_rate = as.numeric(as.character(kddcup$srv_rerror_rate))\n> kddcup$same_srv_rate = as.numeric(as.character(kddcup$same_srv_rate))\n> kddcup$diff_srv_rate = as.numeric(as.character(kddcup$diff_srv_rate))\n> kddcup$srv_diff_host_rate = as.numeric(as.character(kddcup$srv_diff_host_rate))\n> kddcup$dst_host_count = as.numeric(as.character(kddcup$dst_host_count))\n> kddcup$dst_host_srv_count = as.numeric(as.character(kddcup$dst_host_srv_count))\n> kddcup$dst_host_same_srv_rate = as.numeric(as.character(kddcup$dst_host_same_srv_rate))\n> kddcup$dst_host_diff_srv_rate = as.numeric(as.character(kddcup$dst_host_diff_srv_rate))\n> kddcup$dst_host_same_src_port_rate = as.numeric(as.character(kddcup$dst_host_same_src_port_rate))\n> kddcup$dst_host_srv_diff_host_rate = as.numeric(as.character(kddcup$dst_host_srv_diff_host_rate))\n> kddcup$dst_host_serror_rate = as.numeric(as.character(kddcup$dst_host_serror_rate))\n> kddcup$dst_host_srv_serror_rate = as.numeric(as.character(kddcup$dst_host_srv_serror_rate))\n> kddcup$dst_host_rerror_rate = as.numeric(as.character(kddcup$dst_host_rerror_rate))\n> kddcup$dst_host_srv_rerror_rate = as.numeric(as.character(kddcup$dst_host_srv_rerror_rate))\n> kddcup$label = as.character(kddcup$label)\n\n# 攻撃手法をまとめる\n\n> kddcup$label[kddcup$label == \"ipsweep.\"] = \"probe\"\n> kddcup$label[kddcup$label == \"portsweep.\"] = \"probe\"\n> kddcup$label[kddcup$label == \"nmap.\"] = \"probe\"\n> kddcup$label[kddcup$label == \"satan.\"] = \"probe\"\n> kddcup$label[kddcup$label == \"buffer_overflow.\"] = \"u2r\"\n> kddcup$label[kddcup$label == \"loadmodule.\"] = \"u2r\"\n> kddcup$label[kddcup$label == \"perl.\"] = \"u2r\"\n> kddcup$label[kddcup$label == \"rootkit.\"] = \"u2r\"\n> kddcup$label[kddcup$label == \"back.\"] = \"dos\"\n> kddcup$label[kddcup$label == \"land.\"] = \"dos\"\n> kddcup$label[kddcup$label == \"neptune.\"] = \"dos\"\n> kddcup$label[kddcup$label == \"pod.\"] = \"dos\"\n> kddcup$label[kddcup$label == \"smurf.\"] = \"dos\"\n> kddcup$label[kddcup$label == \"teardrop.\"] = \"dos\"\n> kddcup$label[kddcup$label == \"ftp_write.\"] = \"r2l\"\n> kddcup$label[kddcup$label == \"guess_passwd.\"] = \"r2l\"\n> kddcup$label[kddcup$label == \"imap.\"] = \"r2l\"\n> kddcup$label[kddcup$label == \"multihop.\"] = \"r2l\"\n> kddcup$label[kddcup$label == \"phf.\"] = \"r2l\"\n> kddcup$label[kddcup$label == \"spy.\"] = \"r2l\"\n> kddcup$label[kddcup$label == \"warezclient.\"] = \"r2l\"\n> kddcup$label[kddcup$label == \"warezmaster.\"] = \"r2l\"\n> kddcup$label[kddcup$label == \"normal.\"] = \"normal\"\n> kddcup$label = as.factor(kddcup$label)\n\n# 学習データと評価データを分ける(7:3)\n\n> rowdata&lt;-nrow(kddcup)\n> random_ids&lt;-sample(rowdata,rowdata*0.7)\n> kddcup_train&lt;-kddcup[random_ids, ]\n> kddcup_pre&lt;-kddcup[-random_ids, ]</code></pre></div>\n<h3 id=\"svmで学習させる\" style=\"position:relative;\"><a href=\"#svm%E3%81%A7%E5%AD%A6%E7%BF%92%E3%81%95%E3%81%9B%E3%82%8B\" aria-label=\"svmで学習させる permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SVMで学習させる</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># 学習\n\n> kddcup_svm&lt;-ksvm(label ~., data=kddcup_train)\n\n> kddcup_svm\n\n# 結果\n\nSupport Vector Machine object of class \"ksvm\"\n\nSV type: C-svc (classification)\nparameter : cost C = 1\n\nGaussian Radial Basis kernel function.\nHyperparameter : sigma = 0.000103739702263078\n\nNumber of Support Vectors : 8239\n\nObjective Function Value : -329.9296 -738.1392 -65.7569 -28.2657 -670.0012 -175.8475 -32.3014 -70.8226 -27.5727 -27.7096\nTraining error : 0.001939</code></pre></div>\n<p>Training errorを確認すると、まずまず学習できているみたいです。さすが。</p>\n<h3 id=\"評価する\" style=\"position:relative;\"><a href=\"#%E8%A9%95%E4%BE%A1%E3%81%99%E3%82%8B\" aria-label=\"評価する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>評価する</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> result_predict&lt;-predict(kddcup_svm, kddcup_pre)\n> table(result_predict,kddcup_pre$label)\n\nresult_predict dos normal probe r2l u2r\ndos 195344 22 160 0 0\nnormal 108 48781 141 40 28\nprobe 96 40 1724 0 0\nr2l 0 13 0 511 0\nu2r 0 0 0 0 3</code></pre></div>\n<h3 id=\"表でまとめます\" style=\"position:relative;\"><a href=\"#%E8%A1%A8%E3%81%A7%E3%81%BE%E3%81%A8%E3%82%81%E3%81%BE%E3%81%99\" aria-label=\"表でまとめます permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>表でまとめます</h3>\n<table>\n<thead>\n<tr>\n<th>result_prediction</th>\n<th>dos</th>\n<th>normal</th>\n<th>probe</th>\n<th>r2l</th>\n<th>u2r</th>\n<th>適合率</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>dos</td>\n<td>195344</td>\n<td>22</td>\n<td>160</td>\n<td>0</td>\n<td>0</td>\n<td>99.9%</td>\n</tr>\n<tr>\n<td>normal</td>\n<td>108</td>\n<td>48781</td>\n<td>141</td>\n<td>40</td>\n<td>28</td>\n<td>99.3%</td>\n</tr>\n<tr>\n<td>probe</td>\n<td>96</td>\n<td>40</td>\n<td>1724</td>\n<td>0</td>\n<td>0</td>\n<td>92.7%</td>\n</tr>\n<tr>\n<td>r2l</td>\n<td>0</td>\n<td>13</td>\n<td>0</td>\n<td>511</td>\n<td>0</td>\n<td>97.5%</td>\n</tr>\n<tr>\n<td>u2r</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>3</td>\n<td>100%</td>\n</tr>\n<tr>\n<td>再現率</td>\n<td>99.9%</td>\n<td>99.8%</td>\n<td>85.1%</td>\n<td>92.7%</td>\n<td>9.7%</td>\n<td>99.7%</td>\n</tr>\n</tbody>\n</table>\n<p>縦が予測結果で、横が実際のラベルです。総じて上手くいきました。</p>\n<p>ただ、U2Rの精度が低いことが気になります。そもそもデータが少なく学習があまり上手くいっていないのでしょうか。</p>\n<h3 id=\"実際にやってみたc-svmでクロスバリデーション\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E9%9A%9B%E3%81%AB%E3%82%84%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%9Fc-svm%E3%81%A7%E3%82%AF%E3%83%AD%E3%82%B9%E3%83%90%E3%83%AA%E3%83%87%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3\" aria-label=\"実際にやってみたc svmでクロスバリデーション permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実際にやってみた(C-SVMでクロスバリデーション)</h3>\n<p>クロスバリデーション（交差検証）は学習データをいくつかのデータに分け、1つの塊を評価用にそれ以外を学習用としすべての場合を尽くすように学習を進め、汎化性能を上げる手法です。例えば、</p>\n<ol>\n<li>全データをA・B・Cの3つに分けます。</li>\n<li>A・Bを学習データとして学習し、Cを用いて評価します。</li>\n<li>次にB・Cを学習データとし、Aを用いて評価します。</li>\n<li>次にC・Aを学習データとし、Bを用いて評価します。</li>\n<li>それぞれの結果からもっともよい結果をモデルとして採用します。</li>\n</ol>\n<p>こうすることで少ないデータでも汎化性能を上げることができるというものです。当然、分割したデータでそれぞれ学習させるので時間はかかります。</p>\n<p>今回はデータ量も多いので3つに分割して実施します。(K-folds法)　通常は10分割にすることが一般的で、データ量が少ない場合はleave-one-out交差検証とかも使われます。</p>\n<h3 id=\"学習させるc-svm-closs3\" style=\"position:relative;\"><a href=\"#%E5%AD%A6%E7%BF%92%E3%81%95%E3%81%9B%E3%82%8Bc-svm-closs3\" aria-label=\"学習させるc svm closs3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>学習させる(C-SVM closs=3)</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># closs=3で3つに分割して学習\n\n> kddcup_svm&lt;-ksvm(label ~., data=kddcup_train, cross=3)\n\n> kddcup_svm\n\nSupport Vector Machine object of class \"ksvm\"\n\nSV type: C-svc (classification)\nparameter : cost C = 1\n\nGaussian Radial Basis kernel function.\nHyperparameter : sigma = 9.3825289054228e-05\n\nNumber of Support Vectors : 9664\n\nObjective Function Value : -435.7988 -1029.419 -65.9252 -38.3732 -854.7929 -212.3627 -49.4105 -74.7773 -37.6926 -34.5452\nTraining error : 0.001888\nCross validation error : 0.002689</code></pre></div>\n<p>Cross validation errorは上がってしまいました。ただし、クロスバリデーションを用いないときと比べ学習に用いるデータが少ないため、学習の収束は低くでてしまうのは仕方ありません。</p>\n<p>むしろ、収束しきらないところでも高精度を叩きだすことが目的でもありますし。</p>\n<h3 id=\"評価する-1\" style=\"position:relative;\"><a href=\"#%E8%A9%95%E4%BE%A1%E3%81%99%E3%82%8B-1\" aria-label=\"評価する 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>評価する</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> result_predict&lt;-predict(kddcup_svm, kddcup_pre)\n> table(result_predict,kddcup_pre$label)\n\nresult_predict dos normal probe r2l u2r\ndos 117643 7 85 0 0\nnormal 58 28821 95 23 12\nprobe 53 19 1058 0 0\nr2l 0 6 0 324 0\nu2r 0 0 0 0 3\n\n# 誤差率を計算してみる\n\n> 1-sum(diag(kddcup_table))/sum(kddcup_table)\n[1] 0.00241554</code></pre></div>\n<table>\n<thead>\n<tr>\n<th>result_prediction</th>\n<th>dos</th>\n<th>normal</th>\n<th>probe</th>\n<th>r2l</th>\n<th>u2r</th>\n<th>適合率</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>dos</td>\n<td>117643</td>\n<td>7</td>\n<td>85</td>\n<td>0</td>\n<td>0</td>\n<td>99.9%</td>\n</tr>\n<tr>\n<td>normal</td>\n<td>58</td>\n<td>28821</td>\n<td>95</td>\n<td>23</td>\n<td>12</td>\n<td>99.4%</td>\n</tr>\n<tr>\n<td>probe</td>\n<td>53</td>\n<td>19</td>\n<td>1058</td>\n<td>0</td>\n<td>0</td>\n<td>93.6%</td>\n</tr>\n<tr>\n<td>r2l</td>\n<td>0</td>\n<td>6</td>\n<td>0</td>\n<td>324</td>\n<td>0</td>\n<td>98.2%</td>\n</tr>\n<tr>\n<td>u2r</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>3</td>\n<td>100%</td>\n</tr>\n<tr>\n<td>再現率</td>\n<td>99.9%</td>\n<td>99.9%</td>\n<td>85.5%</td>\n<td>93.4%</td>\n<td>20%</td>\n<td>99.8%</td>\n</tr>\n</tbody>\n</table>\n<p>ほんの少しですが精度が上がった気がします。</p>\n<h2 id=\"ニューラルネットでもやってみますnnet\" style=\"position:relative;\"><a href=\"#%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%A9%E3%83%AB%E3%83%8D%E3%83%83%E3%83%88%E3%81%A7%E3%82%82%E3%82%84%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%BE%E3%81%99nnet\" aria-label=\"ニューラルネットでもやってみますnnet permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ニューラルネットでもやってみます(nnet)</h2>\n<p>比較のためにニューラルネットでもやってみます。R言語ではnnetというパッケージでニューラルネットが使えます。</p>\n<p>隠れ層のユニット数は出力結果のラベル数を考慮し、5としてます。(3で実施したら、ラベルが全部でませんでした。)</p>\n<h3 id=\"学習させるnnnet\" style=\"position:relative;\"><a href=\"#%E5%AD%A6%E7%BF%92%E3%81%95%E3%81%9B%E3%82%8Bnnnet\" aria-label=\"学習させるnnnet permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>学習させる(nnnet)</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># パッケージインストール＆適応\n\n> install.packages( \"nnet\" )\n\n> library( nnet )\n\n# 隠れ層のユニット数5、ランダム値範囲-0.1～0.1、減衰5e-4で実施\n\n> kddcup_nnet &lt;- nnet(label~., size=5, data=kddcup_train, rang = .1, decay = 5e-4, maxit = 3000)\n# weights: 615\ninitial value 575217.442435\niter 10 value 74350.753004\niter 20 value 39017.507761\niter 30 value 33989.403391\niter 40 value 30099.250316\niter 50 value 27641.918258\niter 60 value 24688.366217\niter 70 value 23909.225741\niter 80 value 22006.056620\niter 90 value 21385.374653\niter 100 value 20640.355978\niter 110 value 19443.652176\niter 120 value 17966.682333\niter 130 value 17561.847075\niter 140 value 17298.101203\niter 150 value 16746.291929\niter 160 value 16219.714301\niter 170 value 15885.755704\niter 180 value 14769.847387\niter 190 value 14277.103879\niter 200 value 13651.371989\niter 210 value 12878.412456\niter 220 value 12637.064141\niter 230 value 11873.795106\niter 240 value 10919.945647\niter 250 value 9574.787432\niter 260 value 8064.989190\niter 270 value 7261.795869\niter 280 value 5941.270340\niter 290 value 4788.910803\niter 300 value 4263.836429\niter 310 value 4077.903774\niter 320 value 4035.943916\niter 330 value 3953.874037\niter 340 value 3927.603041\niter 350 value 3850.554389\niter 360 value 3690.449366\niter 370 value 3679.445537\niter 380 value 3660.072147\niter 390 value 3654.366314\niter 400 value 3649.497562\niter 410 value 3613.612850\niter 420 value 3546.881873\niter 430 value 3466.460679\niter 440 value 3332.472239\niter 450 value 3202.713314\niter 460 value 3192.588930\niter 470 value 3169.223153\niter 480 value 3097.055361\niter 490 value 2897.312752\niter 500 value 2595.342208\niter 510 value 2323.495624\niter 520 value 2160.486970\niter 530 value 2068.124473\niter 540 value 1986.553216\niter 550 value 1917.448970\niter 560 value 1848.341606\niter 570 value 1826.934175\niter 580 value 1817.437531\niter 590 value 1783.570324\niter 600 value 1749.888183\niter 610 value 1727.915109\niter 620 value 1724.945680\niter 630 value 1712.222157\niter 640 value 1709.191769\niter 650 value 1702.575583\niter 660 value 1689.403803\niter 670 value 1687.694131\niter 680 value 1685.270318\niter 690 value 1684.377098\niter 700 value 1684.111195\niter 710 value 1682.717637\niter 720 value 1682.526618\niter 720 value 1682.526604\niter 730 value 1682.082587\niter 730 value 1682.082587\nfinal value 1682.081493\nconverged</code></pre></div>\n<h3 id=\"評価する-2\" style=\"position:relative;\"><a href=\"#%E8%A9%95%E4%BE%A1%E3%81%99%E3%82%8B-2\" aria-label=\"評価する 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>評価する</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># TypeはClassで\n\n> kddcup_nnet_pre &lt;- predict(kddcup_nnet, kddcup_pre, type=\"class\")\n> table(kddcup_nnet_pre,kddcup_pre$label)\n\nkddcup_nnet_pre dos normal probe r2l u2r\ndos 117326 7 3 4 3\nnormal 3 29315 11 57 7\nprobe 2 0 1164 0 0\nr2l 1 11 0 289 1\nu2r 0 1 0 0 2\n\n# 誤差率を評価する\n> kddcup_table_pre &lt;- table(kddcup_nnet_pre,kddcup_pre$label)\n> 1-sum(diag(kddcup_table_pre))/sum(kddcup_table_pre)\n[1] 0.0007489525</code></pre></div>\n<h3 id=\"表でまとめます-1\" style=\"position:relative;\"><a href=\"#%E8%A1%A8%E3%81%A7%E3%81%BE%E3%81%A8%E3%82%81%E3%81%BE%E3%81%99-1\" aria-label=\"表でまとめます 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>表でまとめます</h3>\n<table>\n<thead>\n<tr>\n<th>result_prediction</th>\n<th>dos</th>\n<th>normal</th>\n<th>probe</th>\n<th>r2l</th>\n<th>u2r</th>\n<th>適合率</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>dos</td>\n<td>117326</td>\n<td>7</td>\n<td>3</td>\n<td>4</td>\n<td>3</td>\n<td>99.99...%</td>\n</tr>\n<tr>\n<td>normal</td>\n<td>3</td>\n<td>29315</td>\n<td>11</td>\n<td>57</td>\n<td>7</td>\n<td>99.7%</td>\n</tr>\n<tr>\n<td>probe</td>\n<td>2</td>\n<td>0</td>\n<td>1164</td>\n<td>0</td>\n<td>0</td>\n<td>99.8%</td>\n</tr>\n<tr>\n<td>r2l</td>\n<td>1</td>\n<td>11</td>\n<td>0</td>\n<td>289</td>\n<td>1</td>\n<td>95.7%</td>\n</tr>\n<tr>\n<td>u2r</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>2</td>\n<td>66.7%</td>\n</tr>\n<tr>\n<td>再現率</td>\n<td>99.99...%</td>\n<td>99.9%</td>\n<td>98.8%</td>\n<td>82.6%</td>\n<td>15.4%</td>\n<td>99.9%</td>\n</tr>\n</tbody>\n</table>\n<p>精度はクロスバリデーションを用いたC-SVMより上がりました?</p>\n<p>過学習っぽい。</p>\n<h3 id=\"おまけ-それぞれのノードの重みを確認する\" style=\"position:relative;\"><a href=\"#%E3%81%8A%E3%81%BE%E3%81%91-%E3%81%9D%E3%82%8C%E3%81%9E%E3%82%8C%E3%81%AE%E3%83%8E%E3%83%BC%E3%83%89%E3%81%AE%E9%87%8D%E3%81%BF%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B\" aria-label=\"おまけ それぞれのノードの重みを確認する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>おまけ それぞれのノードの重みを確認する</h3>\n<p><a href=\"http://hosho.ees.hokudai.ac.jp/~kubo/ce/NeuralNetwork.html\" target=\"_blank\" rel=\"noopener noreferrer\">生態学のデータ解析 - ニューラルネット</a> を参考にニューラルネットのノードを可視化してみます。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">source(\"http://hosho.ees.hokudai.ac.jp/~kubo/log/2007/img07/plot.nn.txt\")\n> plot.nn(kddcup_nnet)</code></pre></div>\n<p><img class=\"lozad\" src=\"data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7\" data-src=\"https://i.imgur.com/Ylygrrb.png\" alt=\":\"></p>\n<p>おお～。可視化するとすごいっすね。</p>\n<h2 id=\"結論\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"結論 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>結論</h2>\n<p>パターン認識にはやはり古典的ではありますが、SVMは単純なパラメータでもかなりの精度を叩きだしました。さらに学習データが十分だと思ってもクロスバリデーションでほんの少し精度を向上できました。</p>\n<p>それ以上に精度を出せたのはニューラルネットとなりました。(過学習気味ですが)ある程度データ量があれば、強力な分類精度を叩きだしますね。</p>\n<h3 id=\"参考文献\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\" aria-label=\"参考文献 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考文献</h3>\n<p><a href=\"http://qiita.com/kokumura/items/64eefc8594995b1d0713\" target=\"_blank\" rel=\"noopener noreferrer\">SVMで天気予報</a></p>\n<p><a href=\"https://fisproject.jp/2014/09/%E3%80%90caret%E3%80%91r%E3%81%A7svm%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E5%AD%A6%E3%81%B6%E3%80%90grid-search%E3%80%91/\" target=\"_blank\" rel=\"noopener noreferrer\">【caret】R で SVM を学ぶ【Grid-Search】</a></p>\n<p><a href=\"http://d.hatena.ne.jp/kj-ki/20120124/p1\" target=\"_blank\" rel=\"noopener noreferrer\">Rでnnetを試してみる</a></p>\n<p><a href=\"http://www1.doshisha.ac.jp/~mjin/R/Chap_23/23.html\" target=\"_blank\" rel=\"noopener noreferrer\">ＲとＷＥＫＡによるニューラルネットワーク</a></p>\n<p><a href=\"http://hosho.ees.hokudai.ac.jp/~kubo/ce/NeuralNetwork.html\" target=\"_blank\" rel=\"noopener noreferrer\">生態学のデータ解析 - ニューラルネット</a></p>","words":2866,"minutes":8}},"staticQueryHashes":["1319877725","2959249232"]}
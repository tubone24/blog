{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2019/11/26/go-lambda","result":{"data":{"content":{"edges":[{"node":{"id":"cc95c6f2-51a1-5df6-8175-66b241fda738","excerpt":"やらねば。（風立ちぬ） 案件でGoを使った開発にシフトしつつあるので必死こいて勉強してるわけですが、AWS LambdaをGoで実装したことがなかったのでちょっと触ってみました、というお話。 Table of Contents AWS LambdaがGo…","fields":{"slug":"2019/11/26/go-lambda"},"frontmatter":{"id":null,"title":"GoでAWS Lambdaを動かして、GitHubAPIv4(GraphQL)を叩いてみた感想","slug":"2019/11/26/go-lambda","date":"2019-11-26T11:31:35.438Z","headerImage":"https://i.imgur.com/h1EK5QS.png","tags":["Go","Lambda","AWS","GraphQL","GitHub"]}}}]}},"pageContext":{"id":"cc95c6f2-51a1-5df6-8175-66b241fda738","index":62,"repHtml":"<p>やらねば。（風立ちぬ）</p>\n<p>案件で<strong>Go</strong>を使った開発にシフトしつつあるので必死こいて勉強してるわけですが、<strong>AWS Lambda</strong>を<strong>Go</strong>で実装したことがなかったのでちょっと触ってみました、というお話。</p>\n<h2 id=\"table-of-contents\" style=\"position:relative;\"><a href=\"#table-of-contents\" aria-label=\"table of contents permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Table of Contents</h2>\n<div class=\"toc\">\n<ul>\n<li>\n<p><a href=\"#aws-lambda%E3%81%8Cgo%E3%81%A7%E5%8B%95%E3%81%8F%E3%81%93%E3%81%A8%E3%82%92%E7%9F%A5%E3%81%A3%E3%81%A6%E3%81%BE%E3%81%99%E3%81%8B\">AWS LambdaがGoで動くことを知ってますか？</a></p>\n</li>\n<li>\n<p><a href=\"#%E4%BB%8A%E5%9B%9E%E3%81%AE%E9%96%8B%E7%99%BA%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%97\">今回の開発スコープ</a></p>\n<ul>\n<li><a href=\"#%E3%82%84%E3%82%8B%E3%81%93%E3%81%A8\">やること</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%81%A8%E3%82%8A%E3%81%82%E3%81%88%E3%81%9A%E3%82%B3%E3%83%BC%E3%83%89\">とりあえずコード</a></p>\n</li>\n<li>\n<p><a href=\"#graphql%E3%82%92go%E3%81%A7%E5%8F%A9%E3%81%8F\">GraphQLをGoで叩く</a></p>\n</li>\n<li>\n<p><a href=\"#lambda%E3%81%A7go%E3%82%92%E4%BD%BF%E3%81%86%E3%81%A8%E3%81%8D\">LambdaでGoを使うとき</a></p>\n</li>\n<li>\n<p><a href=\"#aws-lambda%E3%81%AB%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4%E3%81%99%E3%82%8B\">AWS Lambdaにデプロイする</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%AE%9F%E8%A1%8C\">実行</a></p>\n</li>\n<li>\n<p><a href=\"#%E3%81%8A%E3%81%BE%E3%81%91\">おまけ</a></p>\n</li>\n<li>\n<p><a href=\"#%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%A6%E3%81%AE%E6%84%9F%E6%83%B3\">使ってみての感想</a></p>\n</li>\n</ul>\n</div>\n<h2 id=\"aws-lambdaがgoで動くことを知ってますか\" style=\"position:relative;\"><a href=\"#aws-lambda%E3%81%8Cgo%E3%81%A7%E5%8B%95%E3%81%8F%E3%81%93%E3%81%A8%E3%82%92%E7%9F%A5%E3%81%A3%E3%81%A6%E3%81%BE%E3%81%99%E3%81%8B\" aria-label=\"aws lambdaがgoで動くことを知ってますか permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWS LambdaがGoで動くことを知ってますか？</h2>\n<p><img class=\"lozad\" src=\"data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7\" data-src=\"https://i.imgur.com/h1EK5QS.png\" alt=\"img\"></p>\n<p>知っている人も多いと思いますが、2017年のre:Invent 2017(AWSのカンファレンスイベント)でLambdaに関するアップデートのなかでGoで動くようになったよ～というのがありました。<a href=\"https://www.publickey1.jp/blog/17/aws_lambdanetgoaws_reinvent_2017.html\" target=\"_blank\" rel=\"noopener noreferrer\">［速報］AWS Lambdaが機能強化。.NETとGo言語をサポート、サーバレスアプリケーションのリポジトリも登場。AWS re:Invent 2017\n</a></p>\n<p><img class=\"lozad\" src=\"data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7\" data-src=\"https://www.publickey1.jp/2017/lambda01.gif\" alt=\"img\"></p>\n<p>Lambda自体は、裏側の基盤に<a href=\"https://aws.amazon.com/jp/blogs/news/firecracker-lightweight-virtualization-for-serverless-computing/\" target=\"_blank\" rel=\"noopener noreferrer\">AWS Firecracker</a>を導入したことがきっかけで、集約化と安全性がめちゃんこあがったので、タイムアウトが長くなったり、カスタムランタイムに対応したりと一気に進化したイメージがありましたが、いまだにPythonか、Node.jsで書くかしかして無かったです。（怠け）</p>\n<p><del>どこかでFirecrackerをいじりたいですね。</del></p>\n<p>仕事上使う機会に恵まれたので今回Go Lambdaを初めて触ることにしました。</p>\n<h2 id=\"今回の開発スコープ\" style=\"position:relative;\"><a href=\"#%E4%BB%8A%E5%9B%9E%E3%81%AE%E9%96%8B%E7%99%BA%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%97\" aria-label=\"今回の開発スコープ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>今回の開発スコープ</h2>\n<p>今回はお勉強というか、感触をつかむためにやるだけなのでちゃんとしたサービスは作りません。</p>\n<p>別件で**GitHub API（GraphQL）**を触る必要もあったのでまとめてやってしまいます。</p>\n<h3 id=\"やること\" style=\"position:relative;\"><a href=\"#%E3%82%84%E3%82%8B%E3%81%93%E3%81%A8\" aria-label=\"やること permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>やること</h3>\n<ul>\n<li>\n<p>main.goのみ</p>\n<ul>\n<li>RepositoryとかModelとかUsecaseとかそういうのは作らないよ</li>\n</ul>\n</li>\n<li>\n<p>GitHub APIv4 GraphQLを使うよ</p>\n<ul>\n<li>とりあえず自分の公開されてるレポジトリの使用言語を一覧取るよ</li>\n</ul>\n</li>\n<li>\n<p>手でビルドし、手でデプロイするよ</p>\n</li>\n</ul>\n<h2 id=\"とりあえずコード\" style=\"position:relative;\"><a href=\"#%E3%81%A8%E3%82%8A%E3%81%82%E3%81%88%E3%81%9A%E3%82%B3%E3%83%BC%E3%83%89\" aria-label=\"とりあえずコード permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>とりあえずコード</h2>\n<p>これが作ったショボコードです。追って解説します。</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">package</span> main\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span>\n\t<span class=\"token string\">\"context\"</span>\n\t<span class=\"token string\">\"fmt\"</span>\n\t<span class=\"token string\">\"github.com/shurcooL/githubv4\"</span>\n\t<span class=\"token string\">\"golang.org/x/oauth2\"</span>\n\t<span class=\"token string\">\"github.com/deckarep/golang-set\"</span>\n\t<span class=\"token string\">\"github.com/aws/aws-lambda-go/lambda\"</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">type</span> Language <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tName  <span class=\"token builtin\">string</span>\n\tColor <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> Repository <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tName <span class=\"token builtin\">string</span>\n\tLanguages <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\t\tNodes <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\t\t\tLanguage <span class=\"token string\">`graphql:\"... on Language\"`</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span> <span class=\"token string\">`graphql:\"languages(first: 100)\"`</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> query <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tSearch <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\t\tNodes <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\t\t\tRepository <span class=\"token string\">`graphql:\"... on Repository\"`</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span> <span class=\"token string\">`graphql:\"search(first: 100, query: $q, type: $searchType)\"`</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token keyword\">func</span> getLangList <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>mapset<span class=\"token punctuation\">.</span>Set<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\tsrc <span class=\"token operator\">:=</span> oauth2<span class=\"token punctuation\">.</span><span class=\"token function\">StaticTokenSource</span><span class=\"token punctuation\">(</span>\n\t\t<span class=\"token operator\">&amp;</span>oauth2<span class=\"token punctuation\">.</span>Token<span class=\"token punctuation\">{</span>AccessToken<span class=\"token punctuation\">:</span> <span class=\"token string\">\"7xxxxxxxxxxxxxxxxxxxxxxxx\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">)</span>\n\thttpClient <span class=\"token operator\">:=</span> oauth2<span class=\"token punctuation\">.</span><span class=\"token function\">NewClient</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> src<span class=\"token punctuation\">)</span>\n\n\tclient <span class=\"token operator\">:=</span> githubv4<span class=\"token punctuation\">.</span><span class=\"token function\">NewClient</span><span class=\"token punctuation\">(</span>httpClient<span class=\"token punctuation\">)</span>\n\n\tlanglist <span class=\"token operator\">:=</span> mapset<span class=\"token punctuation\">.</span><span class=\"token function\">NewSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\tvariables <span class=\"token operator\">:=</span> <span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token keyword\">interface</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token string\">\"q\"</span><span class=\"token punctuation\">:</span> githubv4<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"user:tubone24\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//検索するuser名</span>\n\t\t<span class=\"token string\">\"searchType\"</span><span class=\"token punctuation\">:</span>  githubv4<span class=\"token punctuation\">.</span>SearchTypeRepository<span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">}</span>\n\t\n\terr <span class=\"token operator\">:=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">Query</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>query<span class=\"token punctuation\">,</span> variables<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token comment\">// Handle error.</span>\n\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token keyword\">for</span> <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> repo <span class=\"token operator\">:=</span> <span class=\"token keyword\">range</span> query<span class=\"token punctuation\">.</span>Search<span class=\"token punctuation\">.</span>Nodes <span class=\"token punctuation\">{</span>\n\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"---------\"</span><span class=\"token punctuation\">)</span>\n\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>repo<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">for</span> <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> lang <span class=\"token operator\">:=</span> <span class=\"token keyword\">range</span> repo<span class=\"token punctuation\">.</span>Languages<span class=\"token punctuation\">.</span>Nodes <span class=\"token punctuation\">{</span>\n\t\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>lang<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span>\n\t\t\tlanglist<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>lang<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">return</span> langlist\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> LambdaHandler <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">error</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\tresult <span class=\"token operator\">:=</span> <span class=\"token function\">getLangList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Sprint</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">nil</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tlambda<span class=\"token punctuation\">.</span><span class=\"token function\">Start</span><span class=\"token punctuation\">(</span>LambdaHandler<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"graphqlをgoで叩く\" style=\"position:relative;\"><a href=\"#graphql%E3%82%92go%E3%81%A7%E5%8F%A9%E3%81%8F\" aria-label=\"graphqlをgoで叩く permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GraphQLをGoで叩く</h2>\n<p>Goはまぎれもなくサーバーサイドな言語なのでどちらかというと関心事がGraphQLのサーバーサイド実装でBFFたくさん作るのめんどくさいからまとめてGraphQLで返したい！という感じのモチベーションの記事が多めではありますが、ちゃんと<strong>GraphQLクライアント</strong>みつけました。</p>\n<p><a href=\"shurcooL/graphql\">shurcooL/graphql</a></p>\n<p>さらに、<strong>GitHubAPIv4専用のクライアント</strong>も見つけましたのでこっちを使うことにします。</p>\n<p><a href=\"https://github.com/shurcooL/githubv4\" target=\"_blank\" rel=\"noopener noreferrer\">shurcooL/githubv4</a></p>\n<p>話は逸れますがGitHubAPIv4はGitHubの<strong>Personal access tokens</strong>\nで<strong>Access Token</strong>を発行する必要があります。</p>\n<p><a href=\"https://github.com/settings/tokens/new\" target=\"_blank\" rel=\"noopener noreferrer\">New personal access token</a>から発行できます。発行しておきましょう。shurcooL/githubv4でも使います。</p>\n<p><img class=\"lozad\" src=\"data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7\" data-src=\"https://i.imgur.com/k926T60.png\" alt=\"img\"></p>\n<p>shurcooL/githubv4自体の使い方はそこまで難しくなく、HttpClientやAuthをすませた後、<strong>GraphQLのクエリ</strong>を<strong>Goの構造体</strong>として定義して投げつければよいです。</p>\n<p>このようなGraphQLなら・・</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  search(query<span class=\"token operator\">:</span> <span class=\"token string\">\"user:tubone24\"</span><span class=\"token punctuation\">,</span> type<span class=\"token operator\">:</span> REPOSITORY<span class=\"token punctuation\">,</span> first<span class=\"token operator\">:</span> <span class=\"token number\">100</span>) <span class=\"token punctuation\">{</span>\n    edges <span class=\"token punctuation\">{</span>\n      node <span class=\"token punctuation\">{</span>\n        ... on Repository <span class=\"token punctuation\">{</span>\n          name\n          languages(first<span class=\"token operator\">:</span> <span class=\"token number\">100</span>) <span class=\"token punctuation\">{</span>\n            edges <span class=\"token punctuation\">{</span>\n              node <span class=\"token punctuation\">{</span>\n                name\n                color\n              <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>下記のようにすれば取得できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token comment\">//main.go</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span>\n\t<span class=\"token string\">\"context\"</span>\n\t<span class=\"token string\">\"fmt\"</span>\n        <span class=\"token string\">\"golang.org/x/oauth2\"</span>\n\t<span class=\"token string\">\"github.com/shurcooL/githubv4\"</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 構造体でGraphQL定義</span>\n\n<span class=\"token keyword\">type</span> Language <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tName  <span class=\"token builtin\">string</span>\n\tColor <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> Repository <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tName <span class=\"token builtin\">string</span>\n\tLanguages <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\t\tNodes <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\t\t\tLanguage <span class=\"token string\">`graphql:\"... on Language\"`</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span> <span class=\"token string\">`graphql:\"languages(first: 100)\"`</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> query <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tSearch <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\t\tNodes <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\t\t\tRepository <span class=\"token string\">`graphql:\"... on Repository\"`</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span> <span class=\"token string\">`graphql:\"search(first: 100, query: $q, type: $searchType)\"`</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token keyword\">func</span> hoge <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tsrc <span class=\"token operator\">:=</span> oauth2<span class=\"token punctuation\">.</span><span class=\"token function\">StaticTokenSource</span><span class=\"token punctuation\">(</span>\n\t\t<span class=\"token operator\">&amp;</span>oauth2<span class=\"token punctuation\">.</span>Token<span class=\"token punctuation\">{</span>AccessToken<span class=\"token punctuation\">:</span> <span class=\"token string\">\"7xxxxxxxxxxxxxxxxxxxxxxxx\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">)</span> <span class=\"token comment\">//AccessTokenを設定</span>\n\n\thttpClient <span class=\"token operator\">:=</span> oauth2<span class=\"token punctuation\">.</span><span class=\"token function\">NewClient</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> src<span class=\"token punctuation\">)</span> <span class=\"token comment\">//AccessTokenをhttpClientに設定</span>\n\n\tclient <span class=\"token operator\">:=</span> githubv4<span class=\"token punctuation\">.</span><span class=\"token function\">NewClient</span><span class=\"token punctuation\">(</span>httpClient<span class=\"token punctuation\">)</span> <span class=\"token comment\">//先ほど作ったhttpClient使ってclientを作成</span>\n\n\tvariables <span class=\"token operator\">:=</span> <span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token keyword\">interface</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token string\">\"q\"</span><span class=\"token punctuation\">:</span> githubv4<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"user:tubone24\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//検索するuser名</span>\n\t\t<span class=\"token string\">\"searchType\"</span><span class=\"token punctuation\">:</span>  githubv4<span class=\"token punctuation\">.</span>SearchTypeRepository<span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">}</span>\n\t\n\terr <span class=\"token operator\">:=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">Query</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>query<span class=\"token punctuation\">,</span> variables<span class=\"token punctuation\">)</span> <span class=\"token comment\">//client.Queryで実行。エラーのみが戻りで実行結果は咲くほど定義した構造体に格納</span>\n\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token comment\">// Handle error.</span>\n\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token keyword\">for</span> <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> repo <span class=\"token operator\">:=</span> <span class=\"token keyword\">range</span> query<span class=\"token punctuation\">.</span>Search<span class=\"token punctuation\">.</span>Nodes <span class=\"token punctuation\">{</span>\n\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"---------\"</span><span class=\"token punctuation\">)</span>\n\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>repo<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">for</span> <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> lang <span class=\"token operator\">:=</span> <span class=\"token keyword\">range</span> repo<span class=\"token punctuation\">.</span>Languages<span class=\"token punctuation\">.</span>Nodes <span class=\"token punctuation\">{</span>\n\t\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>lang<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span>\n                        fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>lang<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p><strong>あらまぁ、簡単！<strong>と思ったものの、上記のように</strong>Nodes</strong>は取得できたのですが、<strong>Edgesに定義された値</strong>がどうやってもとれない。。</p>\n<p>例えば・・</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"json\"><pre style=\"counter-reset: linenumber 0\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  search(query<span class=\"token operator\">:</span> <span class=\"token string\">\"user:tubone24\"</span><span class=\"token punctuation\">,</span> type<span class=\"token operator\">:</span> REPOSITORY<span class=\"token punctuation\">,</span> first<span class=\"token operator\">:</span> <span class=\"token number\">100</span>) <span class=\"token punctuation\">{</span>\n    edges <span class=\"token punctuation\">{</span>\n      node <span class=\"token punctuation\">{</span>\n        ... on Repository <span class=\"token punctuation\">{</span>\n          name\n          languages(first<span class=\"token operator\">:</span> <span class=\"token number\">100</span>) <span class=\"token punctuation\">{</span>\n            edges <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">              size</span>              node <span class=\"token punctuation\">{</span>\n                name\n                color\n              <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>のようにedgesに項目がありnodeを取りたい場合</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"go\"><pre style=\"counter-reset: linenumber 0\" class=\"language-go line-numbers\"><code class=\"language-go\"><span class=\"token keyword\">type</span> Language <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tName  <span class=\"token builtin\">string</span>\n\tColor <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> Repository <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tName <span class=\"token builtin\">string</span>\n\tLanguages <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">            Edges <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">\t\tNode <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">\t\t\tLanguage <span class=\"token string\">`graphql:\"... on Language\"`</span></span><span class=\"gatsby-highlight-code-line\">\t\t<span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token punctuation\">}</span></span>\t<span class=\"token punctuation\">}</span> <span class=\"token string\">`graphql:\"languages(first: 100)\"`</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> query <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tSearch <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\t\tNodes <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\t\t\tRepository <span class=\"token string\">`graphql:\"... on Repository\"`</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span> <span class=\"token string\">`graphql:\"search(first: 100, query: $q, type: $searchType)\"`</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>とやってもエラーになってしまう・・。</p>\n<p><a href=\"https://github.com/shurcooL/githubv4/issues/30\" target=\"_blank\" rel=\"noopener noreferrer\">こちらのPR</a>の通りEdgesは構造体のスライスで宣言してね～というのも試したのですがうまくいかず。。</p>\n<p>使用言語のサイズが取りたいだけなんですよ…。</p>\n<p><a href=\"https://developer.github.com/v4/object/languageedge/\" target=\"_blank\" rel=\"noopener noreferrer\">取りたい項目</a></p>\n<p>今回は趣旨から反するのでいったん塩漬け。。</p>\n<h2 id=\"lambdaでgoを使うとき\" style=\"position:relative;\"><a href=\"#lambda%E3%81%A7go%E3%82%92%E4%BD%BF%E3%81%86%E3%81%A8%E3%81%8D\" aria-label=\"lambdaでgoを使うとき permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>LambdaでGoを使うとき</h2>\n<p>main関数にはAWSが用意している <code class=\"language-text\">github.com/aws/aws-lambda-go/lambda</code> からロジックを\nInvokeさせないと問答無用でLambdaでエラーになってしまいます。</p>\n<p>そこで <code class=\"language-text\">github.com/aws/aws-lambda-go/lambda</code> の <code class=\"language-text\">lambda.Start</code> を使って動かします。</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"go\"><pre style=\"counter-reset: linenumber 0\" class=\"language-go line-numbers\"><code class=\"language-go\"><span class=\"token keyword\">func</span> LambdaHandler <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">error</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\tresult <span class=\"token operator\">:=</span> <span class=\"token function\">hoge</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//login</span>\n\t<span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Sprint</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">nil</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">\tlambda<span class=\"token punctuation\">.</span><span class=\"token function\">Start</span><span class=\"token punctuation\">(</span>LambdaHandler<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">}</span>\n</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"aws-lambdaにデプロイする\" style=\"position:relative;\"><a href=\"#aws-lambda%E3%81%AB%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4%E3%81%99%E3%82%8B\" aria-label=\"aws lambdaにデプロイする permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWS Lambdaにデプロイする</h2>\n<p>GoをLambdaにデプロイするときは、<strong>実行ファイルにBuild</strong>したものを<strong>ZIPで固めて</strong>あげます。</p>\n<p>Lambda画面のCloud9から編集できないんですね・・・</p>\n<p>実行ファイル、ということはビルドするプラットフォーム(OSとか)に依存してしまうのでは？と思ったのですが、 ベストプラクティスとして <code class=\"language-text\">GOOS=linux</code> をgo build時につけることでLinux互換な実行ファイルになるみたいです。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ GOOS=linux go build main.go</code></pre></div>\n<p>あとは実行ファイルをZIPで固めて、Lambda作ってアップロードして保存すれば終わりです。</p>\n<h2 id=\"実行\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E8%A1%8C\" aria-label=\"実行 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実行</h2>\n<p>Lambdaのテスト実行をしてみます。</p>\n<p><img class=\"lozad\" src=\"data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7\" data-src=\"https://i.imgur.com/HBHjuZk.png\" alt=\"img\"></p>\n<p>無事、GitHubの私のレポジトリ群の言語一覧が取れました。</p>\n<p>printしているものはCloudwatchにも出てきていました。(goのlogを使ってもきちんとCWにログ出るそうです。)</p>\n<p><img class=\"lozad\" src=\"data:image/gif;base64,R0lGODlhAQABAGAAACH5BAEKAP8ALAAAAAABAAEAAAgEAP8FBAA7\" data-src=\"https://i.imgur.com/DDLSLo4.png\" alt=\"img\"></p>\n<p>ひとまず完成っぽいです。</p>\n<h2 id=\"おまけ\" style=\"position:relative;\"><a href=\"#%E3%81%8A%E3%81%BE%E3%81%91\" aria-label=\"おまけ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>おまけ</h2>\n<p>上記のコードでは、レポジトリ群に重複した言語があった場合は重複を避ける形で出力しています。</p>\n<p>PythonではSetという便利なものがあるのですが、Goではあるのでしょうか・・・。</p>\n<p>ありました。</p>\n<p><a href=\"https://github.com/deckarep/golang-set\" target=\"_blank\" rel=\"noopener noreferrer\">deckarep/golang-set</a></p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"go\"><pre style=\"counter-reset: linenumber 0\" class=\"language-go line-numbers\"><code class=\"language-go\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span>\n\t<span class=\"token string\">\"fmt\"</span>\n<span class=\"gatsby-highlight-code-line\">\t<span class=\"token string\">\"github.com/deckarep/golang-set\"</span></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 中略・・</span>\n\n<span class=\"token keyword\">func</span> main <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">\tlanglist <span class=\"token operator\">:=</span> mapset<span class=\"token punctuation\">.</span><span class=\"token function\">NewSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// setを作る</span></span>        <span class=\"token comment\">// 中略</span>\n\t<span class=\"token keyword\">for</span> <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> repo <span class=\"token operator\">:=</span> <span class=\"token keyword\">range</span> query<span class=\"token punctuation\">.</span>Search<span class=\"token punctuation\">.</span>Nodes <span class=\"token punctuation\">{</span>\n\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"---------\"</span><span class=\"token punctuation\">)</span>\n\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>repo<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">for</span> <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> lang <span class=\"token operator\">:=</span> <span class=\"token keyword\">range</span> repo<span class=\"token punctuation\">.</span>Languages<span class=\"token punctuation\">.</span>Nodes <span class=\"token punctuation\">{</span>\n\t\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>lang<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span>\n<span class=\"gatsby-highlight-code-line\">\t\t\tlanglist<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>lang<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span> <span class=\"token comment\">//setにAddする</span></span>\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">return</span> langlist <span class=\"token comment\">// set{hoge, fuga} 重複がないsetが返る</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>便利！</p>\n<p>こういう便利なもの、もっと作っていきたいですね。</p>\n<h2 id=\"使ってみての感想\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%A6%E3%81%AE%E6%84%9F%E6%83%B3\" aria-label=\"使ってみての感想 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使ってみての感想</h2>\n<p>GoでLambdaを組んでみての感想は</p>\n<ul>\n<li>Cloud9で直接Lambda編集したいなぁ…</li>\n<li>lambda.startにラッピングする必要があるのでローカルで確認しにくいなぁ\n<ul>\n<li>こちら解決する方法は次回考えます</li>\n</ul>\n</li>\n<li>果たして早くなったのか？\n<ul>\n<li>わからん。調べたい</li>\n</ul>\n</li>\n</ul>","words":2304,"minutes":6}},"staticQueryHashes":["1319877725","2959249232"]}
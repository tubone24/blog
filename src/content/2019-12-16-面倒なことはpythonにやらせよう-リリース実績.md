---
slug: 2019/12/16/python-auto
title: 面倒なことはPythonにやらせよう@リリース実績
date: 2019-12-15T23:30:57.397Z
description: 頼まれついでにPythonスクリプトを作ってリリース実績を取ってみることにした話
tags:
  - Python
  - GitHub
  - GraphQL
  - GitHub API v4
  - リリース実績
headerImage: 'https://i.imgur.com/QmIHfeR.jpg'
templateKey: blog-post
---
システムのリリース実績を取る必要がでてきたものの、管理表にはしてなかったのでGitHub API v4から取得し、まとめましたというお話

## Table of Contents

```toc

```

## 背景

どうしてこんなことしなきゃいけなくなったかというとちょっとした頼まれごときっかけです。

ふつうシステムをリリースするとリリース管理というリリース日やリリースの内容などをまとめておく管理表があって然るべきなんですが、それがまとまっていなくて困った！なんとかしてというものでした。

困りましたね…。

ただ、我々のソースはGitHubで管理していて、かならずGit Flowというブランチ戦略を取っているのでPRやコミットの履歴を集めればええやんけ！となったわけです。

## GitHub API v4を使う

このブログだと2回目の取り上げになりますが、GitHubのAPIには2種類あります。

GitHub API v3 (RestAPI)とv4(GraphQL)です。

もちろん使い慣れたRestAPIを使ってもいいのですが、GraphQLくらい使えないと会社でバカにされそうなのでGraphQLを使うことにします。

## なぜGraphQLを使わないと会社でバカにされるのか

ちょっと閑話休題。

最近流行ってますね。GraphQL。

こういった新しい技術は会社の若い人たちがどんどん使っていくので追いつくのに必死です。

APIサービスを提供する人も使う人両者からみてRESTよりはいいところがあるから流行るわけですがどういった点でしょうか？

### リソースごとにAPIをコールしなくていい

利用側からするとこれが一番大きいのではないでしょうか？

ちょっと複雑なAPIになるとアルアルなのが、

記事情報APIからコメントIDを取得して、コメントIDを使ってコメントAPIを叩いて、結果からユーザIDをとってユーザーIDを使ってユーザーAPIから……

どんだけリクエストするんや…と。

GraphQLなら自分が必要な項目を必要なだけ取得できます。

### BFFとしてたくさんのエンドポイントを作らなくてよい

## PythonではRequestsが便利だよねっていう話

タイトルの通り面倒なことはPythonに任せようなのでPythonで実装していくわけですが、PythonにはRequestsという超便利ライブラリがあるのでこちらを使ってGraphQLコール部を作っていきます。

次のような形で作るとGraphQLのリクエストができ、PythonのDictで結果を受け取ることができます。

（ソース）



---
templateKey: blog-post
title: test2
date: 2019-08-31T03:33:08.303Z
description: code syntax
featuredpost: true
featuredimage: /img/chemex.jpg
tags:
  - test
image: /img/blog-index.jpg
---
# test

aaa

## test2

aaa

code
```python{numberLines: 5}{1,5-9}
# -*- coding: utf-8 -*-
"""Provides RDB execute
"""
import os

from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from sqlalchemy.exc import SQLAlchemyError
from sqlalchemy.orm.exc import NoResultFound

from .models.uploaded_files_models import Base, UploadedFilesModel

from .utils.logging import get_logger

_logger = get_logger("rdb")


class UploadedFile:
    """Provides UploadFile Sqlite3 operation
    """

    def __init__(self, dbname="ebook-homebrew.sqlite3", echo_log=True):
        """Constructor
        Create Sqlite3 db file and session.
        Args:
            dbname (str): Sqlite3 db name, default is ebook-homebrew.sqlite3
            echo_log (bool): If True, echo DB queries.
        """
        self.dbname = dbname
        self.engine = create_engine(
            "sqlite:///{dbname}".format(dbname=self.dbname), echo=echo_log
        )
        Base.metadata.create_all(self.engine)
        if not os.path.isfile(self.dbname):
            Base.metadata.create_all(self.engine)
        Session = sessionmaker(bind=self.engine)
        self.session = Session()

    def add_uploaded_file(self, name, file_path, file_type, last_index):
        """Insert upload file
        Args:
            name (str): filename
            file_path (str): file path means upload ID
            file_type (str): ContentType like Image/png
            last_index (int): file index
        Returns:
            None: If Success
        Raises:
            SQLAlchemyError: SQL's Error
        """
        try:
            upload_files = UploadedFilesModel(
                name=name,
                file_path=file_path,
                file_type=file_type,
                last_index=last_index,
            )
            self.session.add(upload_files)
            self.session.commit()
        except SQLAlchemyError as err:
            _logger.exception(err)
            self.session.rollback()
            raise err
        except Exception as err:
            _logger.exception(err)
            self.session.rollback()
            raise err
        finally:
            self.session.close()
```

### test3

ss

## test4

aa emoji :100:

